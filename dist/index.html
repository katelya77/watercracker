<!doctype html><html lang="zh-CN"><head><meta charset="utf-8"/><meta name="build-version" content="2025-01-08-05"/><meta name="cache-control" content="no-cache, no-store, must-revalidate"/><meta http-equiv="pragma" content="no-cache"/><meta http-equiv="expires" content="0"/><link rel="icon" href="favicon.ico"/><meta name="viewport" content="width=device-width,initial-scale=1"/><meta name="description" content="深圳市常工电子&quot;蓝牙水控器&quot;控制程序的开源实现。适用于国内各大高校宿舍热水器。"/><meta name="theme-color" content="#fafafa"/><link rel="apple-touch-icon" href="logo192.png"/><link rel="manifest" href="manifest.json"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css"><title>蓝牙水控器 FOSS</title><style>body{background:linear-gradient(135deg,#667eea 0,#764ba2 100%)!important;background-attachment:fixed!important;min-height:100vh!important;margin:0!important;padding:0!important;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif!important;overflow-x:hidden!important}.main{position:absolute!important;left:50%!important;top:50%!important;-webkit-transform:translate(-50%,-50%)!important;transform:translate(-50%,-50%)!important;display:flex!important;align-items:center!important;justify-content:center!important;flex-direction:column!important;background:rgba(255,255,255,.15)!important;backdrop-filter:blur(15px)!important;-webkit-backdrop-filter:blur(15px)!important;border-radius:25px!important;padding:40px 50px!important;border:2px solid rgba(255,255,255,.3)!important;box-shadow:0 15px 45px rgba(0,0,0,.2)!important;min-width:350px!important;max-width:500px!important;text-align:center!important;margin:0!important}.main h2{color:#fff!important;text-shadow:0 3px 6px rgba(0,0,0,.4)!important;margin-top:0!important;margin-bottom:15px!important;font-size:28px!important;font-weight:700!important}.main button{background:linear-gradient(45deg,#667eea,#764ba2)!important;color:#fff!important;border:none!important;padding:12px 30px!important;border-radius:25px!important;font-size:16px!important;font-weight:600!important;cursor:pointer!important;transition:all .3s ease!important;box-shadow:0 4px 15px rgba(0,0,0,.2)!important;margin:10px 0!important;pointer-events:auto!important;user-select:none!important;-webkit-user-select:none!important;-webkit-tap-highlight-color:transparent!important;position:relative!important;z-index:1!important}.main button:hover{transform:translateY(-2px)!important;box-shadow:0 8px 25px rgba(0,0,0,.3)!important;background:linear-gradient(45deg,#5a8ff0,#8959b8)!important}.main button:active{transform:translateY(0)!important;box-shadow:0 2px 10px rgba(0,0,0,.2)!important}.main button:disabled{opacity:.6!important;cursor:not-allowed!important;pointer-events:none!important}.main{pointer-events:auto!important}.main p{color:rgba(255,255,255,.9)!important;margin:8px 0!important;font-size:14px!important}.misc{position:fixed!important;bottom:20px!important;left:50%!important;transform:translateX(-50%)!important;text-align:center!important}.misc a{color:rgba(255,255,255,.7)!important;text-decoration:none!important;margin:0 5px!important}.misc a:hover{color:#fff!important;text-decoration:underline!important}</style><script type="module" crossorigin>var sr=Object.defineProperty;var ir=(e,t,n)=>t in e?sr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var q=(e,t,n)=>ir(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();const Be=[];function _(e){console.log(e),Be.push(e)}function ar(){Be.length=0}function cr(){return Be.length===0}function ur(){return Object.freeze(Be)}function ye(e){return Array.from(new Uint8Array(e)).map(t=>t.toString(16).padStart(2,"0")).join("").toUpperCase()}function ot(e){return e<=0?0:e%10|ot(e/10|0)<<4}if(typeof BluetoothRemoteGATTCharacteristic<"u"){const e=BluetoothRemoteGATTCharacteristic.prototype.writeValue;BluetoothRemoteGATTCharacteristic.prototype.writeValue=function(t){const n="TXD: "+ye(t);return _(n),e.apply(this,arguments)}}const lr=[{isHit:e=>!!e.match(/WATERCTL INTERNAL Unknown RXD data/),output:e=>{e.innerText=`接收到未知数据。可能不影响使用。

这可能是一个 Bug，请截图并`,e.innerHTML+="<a href='https://github.com/celesWuff/waterctl' target='_blank'>反馈给开发者</a>。"},isFatal:!1,showLogs:!0},{isHit:e=>!!e.match(/WATERCTL INTERNAL (?:Refused|Bad key)/),output:e=>{e.innerText=`水控器拒绝启动。

蓝牙水控器 FOSS 当前不支持您的水控器，请不要重试，多次失败可能造成水控器锁定。
若发生锁定，水控器将拒绝一切传入连接；在通电状态下等待约一小时方可恢复。

请截图并`,e.innerHTML+="<a href='https://github.com/celesWuff/waterctl' target='_blank'>反馈给开发者</a>。"},isFatal:!0,showLogs:!0},{isHit:e=>!!e.match(/WATERCTL INTERNAL Operation timed out/),output:e=>{e.innerText=`等待时间似乎太长了。

如果该问题反复发生，这可能是一个 Bug，请截图并`,e.innerHTML+="<a href='https://github.com/celesWuff/waterctl' target='_blank'>反馈给开发者</a>。"},isFatal:!1,showLogs:!0},{isHit:e=>!!e.match(/No Services matching UUID|GATT Error: Not supported/),output:e=>{e.innerText=`不支持的机型。

如果您有能力，欢迎一同参与蓝牙水控器 FOSS 的开发。
详情请参考`,e.innerHTML+="<a href='https://github.com/celesWuff/waterctl' target='_blank'>源代码仓库</a>。"},isFatal:!0,showLogs:!1},{isHit:e=>!!e.match(/User denied the browser permission|Web Bluetooth is not supported|Bluetooth adapter not available/),output:e=>{e.innerText=`设备不支持蓝牙，或浏览器权限未开启。

请参考`,e.innerHTML+="<a href='https://github.com/celesWuff/waterctl/blob/2.x/FAQ.md' target='_blank'>“疑难解答”</a>，按步骤逐步排查。"},isFatal:!0,showLogs:!1},{isHit:e=>!!e.match(/NetworkError|GATT operation failed|GATT Error Unknown/),output:e=>{e.innerText=`连接不稳定，与水控器通信失败。
请重试。`},isFatal:!0,showLogs:!1},{isHit:()=>!0,output:(e,t)=>{e.innerText=t+`

是什么呢

（这可能是一个 Bug，请截图并`,e.innerHTML+="<a href='https://github.com/celesWuff/waterctl' target='_blank'>反馈给开发者</a>。）"},isFatal:!0,showLogs:!0}];function fr(e){for(const t of lr)if(t.isHit(e.toString()))return t;throw new Error(`WATERCTL INTERNAL Unhandled: ${e}`)}const dr=new Uint8Array([254,254,9,176,1,1,0,0]),pr=new Uint8Array([254,254,9,179,0,0]),hr=new Uint8Array([254,254,9,180,0,0]),gr=new Uint8Array([254,254,9,188,0,0]),mr=new Uint8Array([254,254,9,186,0,0]);function _r(e){let t=4119;for(let n=0;n<e.length;n++){t^=e.charCodeAt(n);for(let r=0;r<8;r++)(t&1)==1?(t>>=1,t^=40961):t>>=1}return t}function Er(e){let t=27167;for(let n=0;n<e.length;n++){t^=e[n];for(let r=0;r<8;r++)(t&1)==1?(t>>=1,t^=40961):t>>=1}return t=(t^117)&255,t}const yr=async(e={},t)=>{let n;if(t.startsWith("data:")){const r=t.replace(/^data:.*?base64,/,"");let o;if(typeof Buffer=="function"&&typeof Buffer.from=="function")o=Buffer.from(r,"base64");else if(typeof atob=="function"){const s=atob(r);o=new Uint8Array(s.length);for(let i=0;i<s.length;i++)o[i]=s.charCodeAt(i)}else throw new Error("Failed to decode base64-encoded data URL, Buffer and atob are not supported");n=await WebAssembly.instantiate(o,e)}else{const r=await fetch(t),o=r.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&o.startsWith("application/wasm"))n=await WebAssembly.instantiateStreaming(r,e);else{const s=await r.arrayBuffer();n=await WebAssembly.instantiate(s,e)}}return n.instance},Ar=e=>yr(e,"data:application/wasm;base64,AGFzbQEAAAABCAFgBH9/f38AAwIBAAUDAQABBxQCBm1lbW9yeQIAB21ha2VLZXkAAAq7BAG4BAEFfyABQf8BRiAAQQFxQQFGcQRAIABBAmohAAsgAEGBAkYEQEEAIQALIANBB3EhBCADQX9BB3NxIQggCEEBQQN0cQRAIARBBHMhBAsgCEEBQQR0cQRAIARBBHMhBAsgCEEBQQV0cQRAIARBBHMhBAsgCEEBQQZ0cQRAIARBBHMhBAsgCEEBQQd0cQRAIARBBHMhBAsgBEEAIAFqLQAAcyEEIABBAUEAdHEEQCAEQQFzIQQLIABBAUEBdHEEQCAEQQFzIQQLIABBAUECdHEEQCAEQQJzIQQLIABBAUEDdHEEQCAEQQdzIQQLIABBAUEEdHEEQCAEQQFzIQQLIABBAUEFdHEEQCAEQQFzIQQLIABBAUEGdHEEQCAEQQFzIQQLIABBAUEHdHEEQCAEQQFzIQQLIAJBB3EhBiACQX9BB3NxIQggCEEBQQN0cQRAIAZBBHMhBgsgCEEBQQR0cQRAIAZBBHMhBgsgCEEBQQV0cQRAIAZBBHMhBgsgCEEBQQZ0cQRAIAZBBHMhBgsgCEEBQQd0cQRAIAZBBHMhBgsgBkGABiABQQ9xai0AAHMhBkGAAiABai0AACADcyEDQYAEIABqLQAAIANzIQNBkAogA2otAAAhBUGQBiABai0AACACcyECQZAIIABqLQAAIAJzIQJBkAwgAmotAAAhB0GzEEGSDyAEai0AADoAAEGyEEGQDiAFai0AADoAAEGxEEGiECAGai0AADoAAEGwEEGgDyAHai0AADoAAAsLtxABAEEAC7AQAAQFAAEFBAABBQQBAAQFAAEFBAEABAUBAAQFAAEFBAABBQQBAAQFAQAEBQABBQQBAAQFAAEFBAABBQQBAAQFAAEFBAEABAUBAAQFAAEFBAEABAUAAQUEAAEFBAEABAUBAAQFAAEFBAABBQQBAAQFAAEFBAEABAUBAAQFAAEFBAABBQQBAAQFAQAEBQABBQQBAAQFAAEFBAABBQQBAAQFAQAEBQABBQQAAQUEAQAEBQABBQQBAAQFAQAEBQABBQQBAAQFAAEFBAABBQQBAAQFAAEFBAEABAUBAAQFAAEFBAABBQQBAAQFAQAEBQABBQQBAAQFAAEFBAABBQQBAAQFAABAgcABQYDAAUGAwQBAgcABQYDBAECBwQBAgcABQYDAAUGAwQBAgcEAQIHAAUGAwQBAgcABQYDAAUGAwQBAgcABQYDBAECBwQBAgcABQYDBAECBwAFBgMABQYDBAECBwQBAgcABQYDAAUGAwQBAgcABQYDBAECBwQBAgcABQYDAAUGAwQBAgcEAQIHAAUGAwQBAgcABQYDAAUGAwQBAgcEAQIHAAUGAwAFBgMEAQIHAAUGAwQBAgcEAQIHAAUGAwQBAgcABQYDAAUGAwQBAgcABQYDBAECBwQBAgcABQYDAAUGAwQBAgcEAQIHAAUGAwQBAgcABQYDAAUGAwQBAgcAAAQEAAgMDAgcGBgcFBAQFDQwMDQ8ODg8KCwsKCAkJCBkYGBkbGhobHh8fHhwdHRwUFRUUFhcXFhMSEhMREBARMTAwMTMyMjM2Nzc2NDU1NDw9PTw+Pz8+Ozo6Ozk4ODkoKSkoKisrKi8uLi8tLCwtJSQkJScmJiciIyMiICEhIGFgYGFjYmJjZmdnZmRlZWRsbW1sbm9vbmtqamtpaGhpeHl5eHp7e3p/fn5/fXx8fXV0dHV3dnZ3cnNzcnBxcXBQUVFQUlNTUldWVldVVFRVXVxcXV9eXl9aW1taWFlZWElISElLSkpLTk9PTkxNTUxERUVERkdHRkNCQkNBQEBBAAEBAwMCAgYGBwcFBQQEAAABwQPDwgIGxscHxQUExAzMzQ3PDw7OygoLywnJyAgY2NkZ2xsa2t4eH98d3dwc1BQV1RfX1hYS0tMT0REQ0DDw8THzMzLy9jY39zX19DT8PD39P//+Pjr6+zv5OTj46Cgp6Svr6iou7u8v7S0s7CTk5SXnJybm4iIj4yHh4CBgoKFho2NioqZmZ6dlpaRkrGxtrW+vrm5qqqtrqWloqLh4ebl7u7p6fr6/f719fLx0tLV1t3d2trJyc7NxsbBwkFBRkVOTklJWlpdXlVVUlFycnV2fX16emlpbm1mZmFhIiIlJi0tKio5OT49NjYxMhERFhUeHhkZCgoNDgUFAgFAAkGDwwFCgMMBQoDAAkGDwwFCgMACQYPAAkGDwwFCgMMBQoDAAkGDwAJBg8MBQoDAAkGDwwFCgMMBQoDAAkGDwwFCgMACQYPAAkGDwwFCgMACQYPDAUKAwwFCgMACQYPAAkGDwwFCgMMBQoDAAkGDwwFCgMACQYPAAkGDwwFCgMMBQoDAAkGDwAJBg8MBQoDAAkGDwwFCgMMBQoDAAkGDwAJBg8MBQoDDAUKAwAJBg8MBQoDAAkGDwAJBg8MBQoDAAkGDwwFCgMMBQoDAAkGDwwFCgMACQYPAAkGDwwFCgMMBQoDAAkGDwAJBg8MBQoDAAkGDwwFCgMMBQoDAAkGDwAAECAwQFBgcICQoLDA0ODxAREhMRFBEVFhcYGRobHB0THh8gISIPIxghJBAjJSYfIicoKSorLC0lIA8MEy4vKjAXMTIzNDU2NzgDOToNJDknIiUGOzw9Pj8FD0BBQkM6REVGLx4FK0cTSElKSx8bPkxNIA5MTk9QUVIxHklTIlQYVVYQV1hZWkIkDVszXF0UIF5DXx1WVQs6YGFBYjk3Y2QEBmUIZmdoESBpF2EbHmoxFms2bAc4bW48Um8mQXAncVo0RHJzAUwKahYcdBkWK1FOdRJcPRVdAiJTTxFpdikJWXcbeER5ensFD3wrAX0sVQYFfgx/gA8AGoEDMR48eAABAgMABAUGBwgJCgsMDQ4DDxAREhMUFRYXGBkaGxwdFh4fICEiIyQlJhQnKCkqKywcLSInDC4vMDEyMzQ1NjMTNAI3ODk6OzwaFD0EPj9AQUIeQ0RFDUZHSElIJEpISx9MG01LAU5FTRMcTjUfJyRPKFAkNxM1G1FSJk9TVB0cJkZEVUJGVjkzP1dYKwlZWlNbXEgxLRw+XUcXXkpfMi9SYD8mYRMUYmNkK2UeZmc6ZRgnDARoQ0ATaWo3axQabEldXgptAgEQWWdub0twbEVxBgByEXN0AzhscEF1D3Y1Vicecw1cNUh3eHk7eho9ex18EUx9Lhh+fwU8gAeBRgx1N1Ih9tVI2KC5vMySOVTz+T7iV6NbxlXRlzJmxWTANGXJUb1h1xJFcmqsWSDKXzDBY2fNWDUjXFrU8l2nFPVgOEbEpmhAJ6IcqdNBMZH40AQMx4kkVtJCGEPwCqQZGza3zyJt2fcWSRU9oWJTOhOo9Mi66x5EbxDDD6VQ1mkA8Xfpz/Ki1bdGwFkgQ0VMRVPUYTnyIVpcIzVYzWdjVcGmxEY489Vg9RSnXUjXUUVmNEHTqRxXolnAMCdAaCSJxwwE0PgxVGWRksy8uaDY9lI3dWTFMpfRxls+o+L5Er3JrF/KIGpyHqHruvDIbz0ZpERp1lClD8MQQ+l38QBWChhC0m0iz7c2GxVJFvfZ9KgTOlNiMevz17o3ZZJXVUZGPDM=");function br(){const e=Math.floor(Math.random()*9999)+1;return new Uint8Array([e>>8,e&255]).map(ot)}function Sr(){const e=new Date().toLocaleString("zh-CN",{timeZone:"Asia/Shanghai"}),t=e.split(" ")[0].split("/").map(o=>parseInt(o)),n=e.split(" ")[1].split(":").map(o=>parseInt(o));return[t[0]%100,...t.slice(1),...n].map(ot)}async function wr(e){const{makeKey:t,memory:n}=(await Ar()).exports;if(e.length!==4)throw new Error("WATERCTL INTERNAL Bad unlock request");t(...e);const r=new Uint32Array(n.buffer)[524];return new Uint8Array([r>>24&255,r>>16&255,r>>8&255,r&255])}async function Tr(e,t){const n=new Uint8Array(e),r=n[5],o=n.slice(6,8),s=n.slice(8,10),i=o[0]<<8|o[1],a=i+1,c=i===65535?new Uint8Array([1,0]):new Uint8Array([a>>8&255,a&255]),u=await wr(new Uint8Array([...o,...s])),l=t.slice(-4).split("").map(T=>T.charCodeAt(0)-48),f=u.map((T,A)=>T^l[A]),h=new Uint8Array([r,...c,...f,254,135,0,0,0,0,0,0]),d=Er(h);return new Uint8Array([254,254,9,175,d,...h])}function ue(e,t=!1){const n=_r(e.slice(-5)),r=t?11:255,o=br(),s=Sr();return new Uint8Array([254,254,9,178,1,n&255,n>>8,r,0,...o,...s,15,39,0])}function Br(e){return e.includes(152)&&e.includes(4)?"NEW_V2":e.includes(122)||e.includes(142)||e.includes(176)||e.includes(174)||e.includes(175)?"NEW_V1":"LEGACY"}class Ir{constructor(){q(this,"firmwareVersion","UNKNOWN");q(this,"authState","INIT");q(this,"retryCount",0);q(this,"maxRetries",3);_("协议适配器初始化")}async handlePacket(t,n){_(`接收数据: ${ye(t.buffer)}`),this.firmwareVersion==="UNKNOWN"&&(this.firmwareVersion=Br(t),_(`检测到固件版本: ${this.firmwareVersion}`));const r=t[3],o=t.length>5?t[5]:0;try{switch(this.firmwareVersion){case"NEW_V2":return await this.handleNewV2Protocol(r,o,t,n);case"NEW_V1":return await this.handleNewV1Protocol(r,o,t,n);default:return await this.handleLegacyProtocol(r,o,t,n)}}catch(s){return _(`协议处理错误: ${s}`),await this.handleRetry(t,n)}}async handleNewV2Protocol(t,n,r,o){switch(_(`处理V2协议 - dType: 0x${t.toString(16)}, subType: 0x${n.toString(16)}`),t){case 152:return await this.handleExtendedHandshake(r,o);case 122:return await this.handleNewAuthStep(r,o);case 4:return await this.handleVersionInfo(r,o);default:return!1}}async handleNewV1Protocol(t,n,r,o){switch(_(`处理V1协议 - dType: 0x${t.toString(16)}`),t){case 176:case 177:return _("V1协议：处理0xb0/0xb1握手包"),!1;case 174:return _("V1协议：处理0xae密钥包"),!1;case 175:return _("V1协议：处理0xaf认证包"),!1;case 178:return _("V1协议：收到0xb2启动成功响应，通知原有逻辑处理"),!1;case 122:return await this.handleNewAuthStep(r,o);case 142:return await this.handleKeyExchange(r,o);default:return!1}}async handleLegacyProtocol(t,n,r,o){return!1}async handleExtendedHandshake(t,n){_("处理扩展握手");const r=new Uint8Array([254,254,9,152,4,0,0,1,...this.generateTimestamp(),0,0]);return await this.sendWithDelay(n,r,200),this.authState="EXTENDED_HANDSHAKE_SENT",!0}async handleNewAuthStep(t,n){_("处理新认证步骤");const r=t.length>4?t[4]:1,o=new Uint8Array([254,254,9,122,r,1,2,1,3,4,5,6,7,8,9,16,17,18]);return await this.sendWithDelay(n,o,300),this.authState="NEW_AUTH_SENT",!0}async handleVersionInfo(t,n){_("处理版本信息请求");const r=new Uint8Array([254,254,9,4,1,0]);return await this.sendWithDelay(n,r,100),!0}async handleKeyExchange(t,n){_("处理密钥交换");const r=t.slice(4,8),o=new Uint8Array([254,254,9,142,...r,1,2,3,4]);return await this.sendWithDelay(n,o,250),!0}async handleRetry(t,n){if(this.retryCount<this.maxRetries){this.retryCount++,_(`尝试重试 (${this.retryCount}/${this.maxRetries})`);const r=new Uint8Array([254,254,9,t[3],1,0]);return await this.sendWithDelay(n,r,500),!0}return _("重试次数已达上限"),!1}async sendWithDelay(t,n,r){_(`发送数据: ${ye(n.buffer)} (延时: ${r}ms)`),await new Promise(o=>setTimeout(o,r)),await t.writeValue(n)}generateTimestamp(){const t=new Date;return new Uint8Array([t.getSeconds()&255,t.getMinutes()&255,t.getHours()&255,t.getDate()&255])}reset(){this.firmwareVersion="UNKNOWN",this.authState="INIT",this.retryCount=0,_("协议适配器已重置")}getStatus(){return{firmware:this.firmwareVersion,auth:this.authState,retries:this.retryCount}}}let v,B,Qe,st=!1,ee,K,Ae;function it(e){const t=document.getElementById("main-button"),n=document.getElementById("device-name");switch(e){case"pending":t.innerText="请稍候",t.disabled=!0,n.innerText="已连接："+v.name;break;case"ok":t.innerText="结束",t.disabled=!1;break;case"standby":t.innerText="开启",t.disabled=!1,n.innerText="未连接";break}}async function mn(){v&&v.gatt.disconnect(),st=!1,ar(),clearTimeout(K),clearTimeout(Ae),ee&&ee.reset(),it("standby")}async function Ie(e){if(!e)throw e;const t=e.toString();if(t.match(/User cancelled/)||t=="2")return;const n=document.getElementById("dialog-content"),r=document.getElementById("dialog-debug-container"),o=document.getElementById("dialog-debug-content"),{output:s,isFatal:i,showLogs:a}=fr(e);throw s(n,e),r.style.display="none",!cr()&&a&&(r.style.display="block",o.innerText=`调试信息：
`+ur().join(`
`)),document.getElementById("dialog").showModal(),i&&mn(),e}async function kr(e){const t=e.target.value;_("RXD: "+ye(t.buffer));try{let n=new Uint8Array(t.buffer);if(n[0]===65&&n[1]===84&&n[2]===43)return;if(n[0]!==253&&n[0]!==9)throw new Error("WATERCTL INTERNAL Unknown RXD data");if(n[1]===9&&(n=new Uint8Array([253,...n])),n[0]===9&&(n=new Uint8Array([253,253,...n])),n.length<4||ee&&await ee.handlePacket(n,B))return;switch(n[3]){case 176:case 177:clearTimeout(K),K=setTimeout(()=>{B.writeValue(ue(v.name))},500);break;case 174:clearTimeout(K),await B.writeValue(await Tr(n.buffer,v.name));break;case 175:switch(n[5]){case 85:await B.writeValue(ue(v.name,!0));break;case 122:_("检测到新固件0xaf包中的0x7a响应，继续发送start epilogue"),setTimeout(async()=>{try{await B.writeValue(ue(v.name,!0)),_("NEW_V1固件：已发送start epilogue，等待0xb2响应")}catch(o){_("NEW_V1固件：发送start epilogue失败: "+o)}},800);break;case 1:case 2:case 4:throw new Error("WATERCTL INTERNAL Bad key");default:_(`警告：收到未知的0xaf响应码: 0x${n[5].toString(16)}，尝试继续`),await B.writeValue(ue(v.name,!0));break}break;case 178:_("🎉 收到0xB2启动成功响应！水控器已激活"),clearTimeout(K),clearTimeout(Ae),st=!0,it("ok");break;case 179:await B.writeValue(hr),mn();break;case 170:case 181:case 184:break;case 186:await B.writeValue(mr);break;case 188:await B.writeValue(gr);break;case 200:throw new Error("WATERCTL INTERNAL Refused");default:throw new Error("WATERCTL INTERNAL Unknown RXD data")}}catch(n){Ie(n)}}function _n(){Ae||(Ae=setTimeout(()=>{Ie("WATERCTL INTERNAL Operation timed out")},25e3))}async function vr(){try{if(!navigator.bluetooth)throw new Error("蓝牙API不可用");v=await navigator.bluetooth.requestDevice({filters:Array.from("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ").map(n=>({namePrefix:n})),optionalServices:[window.navigator.userAgent.match(/Bluefy/)?"generic_access":61936]}),it("pending");const t=await(await v.gatt.connect()).getPrimaryService(61936);B=await t.getCharacteristic(61937),Qe=await t.getCharacteristic(61938),ee=new Ir,_("协议适配器已初始化，支持新版固件适配"),await Qe.startNotifications(),Qe.addEventListener("characteristicvaluechanged",kr),await B.writeValue(dr),_n()}catch(e){Ie(e)}}async function Dr(){try{await B.writeValue(pr),_n()}catch(e){Ie(e)}}function En(){st?Dr():vr()}const Rr=()=>{navigator.serviceWorker&&!navigator.serviceWorker.controller&&location.protocol==="https:"&&navigator.serviceWorker.register("serviceworker.js")},Cr=()=>{const e=document.getElementById("install-button");if(!e){console.warn("安装按钮未找到");return}e.hidden=!1,console.log("✅ 安装按钮已显示"),window.addEventListener("beforeinstallprompt",t=>{console.log("🚀 PWA安装提示事件触发"),t.preventDefault(),window.deferredPrompt=t,e.hidden=!1,e.style.display="block"}),e.addEventListener("click",async()=>{console.log("🔘 安装按钮被点击");const t=window.deferredPrompt;if(!t){console.log("⚠️ 没有PWA安装提示事件，可能已经安装或不支持"),alert("该应用可能已经安装，或者您的浏览器不支持PWA安装功能");return}try{t.prompt();const n=await t.userChoice;console.log("📱 PWA安装选择:",n.outcome),window.deferredPrompt=null,n.outcome==="accepted"&&(e.hidden=!0)}catch(n){console.error("PWA安装出错:",n)}}),window.addEventListener("appinstalled",()=>{console.log("🎉 PWA已成功安装"),window.deferredPrompt=null,e.hidden=!0})},Nr=()=>{window.resizeTo(538,334)},g=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,m=globalThis,P="9.46.0";function ke(){return ve(m),m}function ve(e){const t=e.__SENTRY__=e.__SENTRY__||{};return t.version=t.version||P,t[P]=t[P]||{}}function re(e,t,n=m){const r=n.__SENTRY__=n.__SENTRY__||{},o=r[P]=r[P]||{};return o[e]||(o[e]=t())}const xr=["debug","info","warn","error","log","assert","trace"],Fr="Sentry Logger ",be={};function X(e){if(!("console"in m))return e();const t=m.console,n={},r=Object.keys(be);r.forEach(o=>{const s=be[o];n[o]=t[o],t[o]=s});try{return e()}finally{r.forEach(o=>{t[o]=n[o]})}}function Qr(){ct().enabled=!0}function Lr(){ct().enabled=!1}function yn(){return ct().enabled}function Mr(...e){at("log",...e)}function Pr(...e){at("warn",...e)}function Or(...e){at("error",...e)}function at(e,...t){g&&yn()&&X(()=>{m.console[e](`${Fr}[${e}]:`,...t)})}function ct(){return g?re("loggerSettings",()=>({enabled:!1})):{enabled:!1}}const p={enable:Qr,disable:Lr,isEnabled:yn,log:Mr,warn:Pr,error:Or},An=50,O="?",St=/\(error: (.*)\)/,wt=/captureMessage|captureException/;function bn(...e){const t=e.sort((n,r)=>n[0]-r[0]).map(n=>n[1]);return(n,r=0,o=0)=>{const s=[],i=n.split(`
`);for(let a=r;a<i.length;a++){const c=i[a];if(c.length>1024)continue;const u=St.test(c)?c.replace(St,"$1"):c;if(!u.match(/\S*Error: /)){for(const l of t){const f=l(u);if(f){s.push(f);break}}if(s.length>=An+o)break}}return $r(s.slice(o))}}function Ur(e){return Array.isArray(e)?bn(...e):e}function $r(e){if(!e.length)return[];const t=Array.from(e);return/sentryWrapped/.test(le(t).function||"")&&t.pop(),t.reverse(),wt.test(le(t).function||"")&&(t.pop(),wt.test(le(t).function||"")&&t.pop()),t.slice(0,An).map(n=>({...n,filename:n.filename||le(t).filename,function:n.function||O}))}function le(e){return e[e.length-1]||{}}const Le="<anonymous>";function x(e){try{return!e||typeof e!="function"?Le:e.name||Le}catch{return Le}}function Tt(e){const t=e.exception;if(t){const n=[];try{return t.values.forEach(r=>{r.stacktrace.frames&&n.push(...r.stacktrace.frames)}),n}catch{return}}}const me={},Bt={};function G(e,t){me[e]=me[e]||[],me[e].push(t)}function W(e,t){if(!Bt[e]){Bt[e]=!0;try{t()}catch(n){g&&p.error(`Error while instrumenting ${e}`,n)}}}function k(e,t){const n=e&&me[e];if(n)for(const r of n)try{r(t)}catch(o){g&&p.error(`Error while triggering instrumentation handler.
Type: ${e}
Name: ${x(r)}
Error:`,o)}}let Me=null;function Hr(e){const t="error";G(t,e),W(t,Gr)}function Gr(){Me=m.onerror,m.onerror=function(e,t,n,r,o){return k("error",{column:r,error:o,line:n,msg:e,url:t}),Me?Me.apply(this,arguments):!1},m.onerror.__SENTRY_INSTRUMENTED__=!0}let Pe=null;function Wr(e){const t="unhandledrejection";G(t,e),W(t,jr)}function jr(){Pe=m.onunhandledrejection,m.onunhandledrejection=function(e){return k("unhandledrejection",e),Pe?Pe.apply(this,arguments):!0},m.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const Sn=Object.prototype.toString;function ut(e){switch(Sn.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return F(e,Error)}}function J(e,t){return Sn.call(e)===`[object ${t}]`}function wn(e){return J(e,"ErrorEvent")}function It(e){return J(e,"DOMError")}function Vr(e){return J(e,"DOMException")}function R(e){return J(e,"String")}function lt(e){return typeof e=="object"&&e!==null&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function ft(e){return e===null||lt(e)||typeof e!="object"&&typeof e!="function"}function te(e){return J(e,"Object")}function De(e){return typeof Event<"u"&&F(e,Event)}function Yr(e){return typeof Element<"u"&&F(e,Element)}function zr(e){return J(e,"RegExp")}function Re(e){return!!(e!=null&&e.then&&typeof e.then=="function")}function Xr(e){return te(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}function F(e,t){try{return e instanceof t}catch{return!1}}function Tn(e){return!!(typeof e=="object"&&e!==null&&(e.__isVue||e._isVue))}function Jr(e){return typeof Request<"u"&&F(e,Request)}const dt=m,qr=80;function Bn(e,t={}){if(!e)return"<unknown>";try{let n=e;const r=5,o=[];let s=0,i=0;const a=" > ",c=a.length;let u;const l=Array.isArray(t)?t:t.keyAttrs,f=!Array.isArray(t)&&t.maxStringLength||qr;for(;n&&s++<r&&(u=Kr(n,l),!(u==="html"||s>1&&i+o.length*c+u.length>=f));)o.push(u),i+=u.length,n=n.parentNode;return o.reverse().join(a)}catch{return"<unknown>"}}function Kr(e,t){const n=e,r=[];if(!(n!=null&&n.tagName))return"";if(dt.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const o=t!=null&&t.length?t.filter(i=>n.getAttribute(i)).map(i=>[i,n.getAttribute(i)]):null;if(o!=null&&o.length)o.forEach(i=>{r.push(`[${i[0]}="${i[1]}"]`)});else{n.id&&r.push(`#${n.id}`);const i=n.className;if(i&&R(i)){const a=i.split(/\s+/);for(const c of a)r.push(`.${c}`)}}const s=["aria-label","type","name","title","alt"];for(const i of s){const a=n.getAttribute(i);a&&r.push(`[${i}="${a}"]`)}return r.join("")}function pt(){try{return dt.document.location.href}catch{return""}}function Zr(e){if(!dt.HTMLElement)return null;let t=e;const n=5;for(let r=0;r<n;r++){if(!t)return null;if(t instanceof HTMLElement){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}t=t.parentNode}return null}function Se(e,t=0){return typeof e!="string"||t===0||e.length<=t?e:`${e.slice(0,t)}...`}function kt(e,t){if(!Array.isArray(e))return"";const n=[];for(let r=0;r<e.length;r++){const o=e[r];try{Tn(o)?n.push("[VueViewModel]"):n.push(String(o))}catch{n.push("[value cannot be serialized]")}}return n.join(t)}function eo(e,t,n=!1){return R(e)?zr(t)?t.test(e):R(t)?n?e===t:e.includes(t):!1:!1}function Ce(e,t=[],n=!1){return t.some(r=>eo(e,r,n))}function w(e,t,n){if(!(t in e))return;const r=e[t];if(typeof r!="function")return;const o=n(r);typeof o=="function"&&In(o,r);try{e[t]=o}catch{g&&p.log(`Failed to replace method "${t}" in object`,e)}}function U(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch{g&&p.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function In(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,U(e,"__sentry_original__",t)}catch{}}function ht(e){return e.__sentry_original__}function kn(e){if(ut(e))return{message:e.message,name:e.name,stack:e.stack,...Dt(e)};if(De(e)){const t={type:e.type,target:vt(e.target),currentTarget:vt(e.currentTarget),...Dt(e)};return typeof CustomEvent<"u"&&F(e,CustomEvent)&&(t.detail=e.detail),t}else return e}function vt(e){try{return Yr(e)?Bn(e):Object.prototype.toString.call(e)}catch{return"<unknown>"}}function Dt(e){if(typeof e=="object"&&e!==null){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}else return{}}function to(e,t=40){const n=Object.keys(kn(e));n.sort();const r=n[0];if(!r)return"[object has no keys]";if(r.length>=t)return Se(r,t);for(let o=n.length;o>0;o--){const s=n.slice(0,o).join(", ");if(!(s.length>t))return o===n.length?s:Se(s,t)}return""}function no(){const e=m;return e.crypto||e.msCrypto}function I(e=no()){let t=()=>Math.random()*16;try{if(e!=null&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e!=null&&e.getRandomValues&&(t=()=>{const n=new Uint8Array(1);return e.getRandomValues(n),n[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,n=>(n^(t()&15)>>n/4).toString(16))}function vn(e){var t,n;return(n=(t=e.exception)==null?void 0:t.values)==null?void 0:n[0]}function M(e){const{message:t,event_id:n}=e;if(t)return t;const r=vn(e);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function We(e,t,n){const r=e.exception=e.exception||{},o=r.values=r.values||[],s=o[0]=o[0]||{};s.value||(s.value=t||""),s.type||(s.type="Error")}function j(e,t){const n=vn(e);if(!n)return;const r={type:"generic",handled:!0},o=n.mechanism;if(n.mechanism={...r,...o,...t},t&&"data"in t){const s={...o==null?void 0:o.data,...t.data};n.mechanism.data=s}}function Rt(e){if(ro(e))return!0;try{U(e,"__sentry_captured__",!0)}catch{}return!1}function ro(e){try{return e.__sentry_captured__}catch{}}const Dn=1e3;function oe(){return Date.now()/Dn}function oo(){const{performance:e}=m;if(!(e!=null&&e.now)||!e.timeOrigin)return oe;const t=e.timeOrigin;return()=>(t+e.now())/Dn}let Ct;function C(){return(Ct??(Ct=oo()))()}function so(e){const t=C(),n={sid:I(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>ao(n)};return e&&V(n,e),n}function V(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),!e.did&&!t.did&&(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||C(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=t.sid.length===32?t.sid:I()),t.init!==void 0&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),typeof t.started=="number"&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if(typeof t.duration=="number")e.duration=t.duration;else{const n=e.timestamp-e.started;e.duration=n>=0?n:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),typeof t.errors=="number"&&(e.errors=t.errors),t.status&&(e.status=t.status)}function io(e,t){let n={};e.status==="ok"&&(n={status:"exited"}),V(e,n)}function ao(e){return{sid:`${e.sid}`,init:e.init,started:new Date(e.started*1e3).toISOString(),timestamp:new Date(e.timestamp*1e3).toISOString(),status:e.status,errors:e.errors,did:typeof e.did=="number"||typeof e.did=="string"?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}}}function se(e,t,n=2){if(!t||typeof t!="object"||n<=0)return t;if(e&&Object.keys(t).length===0)return e;const r={...e};for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=se(r[o],t[o],n-1));return r}function Nt(){return I()}function Rn(){return I().substring(16)}const je="_sentrySpan";function xt(e,t){t?U(e,je,t):delete e[je]}function Ft(e){return e[je]}const co=100;class N{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:Nt(),sampleRand:Math.random()}}clone(){const t=new N;return t._breadcrumbs=[...this._breadcrumbs],t._tags={...this._tags},t._extra={...this._extra},t._contexts={...this._contexts},this._contexts.flags&&(t._contexts.flags={values:[...this._contexts.flags.values]}),t._user=this._user,t._level=this._level,t._session=this._session,t._transactionName=this._transactionName,t._fingerprint=this._fingerprint,t._eventProcessors=[...this._eventProcessors],t._attachments=[...this._attachments],t._sdkProcessingMetadata={...this._sdkProcessingMetadata},t._propagationContext={...this._propagationContext},t._client=this._client,t._lastEventId=this._lastEventId,xt(t,Ft(this)),t}setClient(t){this._client=t}setLastEventId(t){this._lastEventId=t}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&V(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(t){return this._tags={...this._tags,...t},this._notifyScopeListeners(),this}setTag(t,n){return this._tags={...this._tags,[t]:n},this._notifyScopeListeners(),this}setExtras(t){return this._extra={...this._extra,...t},this._notifyScopeListeners(),this}setExtra(t,n){return this._extra={...this._extra,[t]:n},this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,n){return n===null?delete this._contexts[t]:this._contexts[t]=n,this._notifyScopeListeners(),this}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;const n=typeof t=="function"?t(this):t,r=n instanceof N?n.getScopeData():te(n)?t:void 0,{tags:o,extra:s,user:i,contexts:a,level:c,fingerprint:u=[],propagationContext:l}=r||{};return this._tags={...this._tags,...o},this._extra={...this._extra,...s},this._contexts={...this._contexts,...a},i&&Object.keys(i).length&&(this._user=i),c&&(this._level=c),u.length&&(this._fingerprint=u),l&&(this._propagationContext=l),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,xt(this,void 0),this._attachments=[],this.setPropagationContext({traceId:Nt(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(t,n){var s;const r=typeof n=="number"?n:co;if(r<=0)return this;const o={timestamp:oe(),...t,message:t.message?Se(t.message,2048):t.message};return this._breadcrumbs.push(o),this._breadcrumbs.length>r&&(this._breadcrumbs=this._breadcrumbs.slice(-r),(s=this._client)==null||s.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Ft(this)}}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata=se(this._sdkProcessingMetadata,t,2),this}setPropagationContext(t){return this._propagationContext=t,this}getPropagationContext(){return this._propagationContext}captureException(t,n){const r=(n==null?void 0:n.event_id)||I();if(!this._client)return g&&p.warn("No client configured on scope - will not capture exception!"),r;const o=new Error("Sentry syntheticException");return this._client.captureException(t,{originalException:t,syntheticException:o,...n,event_id:r},this),r}captureMessage(t,n,r){const o=(r==null?void 0:r.event_id)||I();if(!this._client)return g&&p.warn("No client configured on scope - will not capture message!"),o;const s=new Error(t);return this._client.captureMessage(t,n,{originalException:t,syntheticException:s,...r,event_id:o},this),o}captureEvent(t,n){const r=(n==null?void 0:n.event_id)||I();return this._client?(this._client.captureEvent(t,{...n,event_id:r},this),r):(g&&p.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(t=>{t(this)}),this._notifyingListeners=!1)}}function uo(){return re("defaultCurrentScope",()=>new N)}function lo(){return re("defaultIsolationScope",()=>new N)}class fo{constructor(t,n){let r;t?r=t:r=new N;let o;n?o=n:o=new N,this._stack=[{scope:r}],this._isolationScope=o}withScope(t){const n=this._pushScope();let r;try{r=t(n)}catch(o){throw this._popScope(),o}return Re(r)?r.then(o=>(this._popScope(),o),o=>{throw this._popScope(),o}):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const t=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:t}),t}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function Y(){const e=ke(),t=ve(e);return t.stack=t.stack||new fo(uo(),lo())}function po(e){return Y().withScope(e)}function ho(e,t){const n=Y();return n.withScope(()=>(n.getStackTop().scope=e,t(e)))}function Qt(e){return Y().withScope(()=>e(Y().getIsolationScope()))}function go(){return{withIsolationScope:Qt,withScope:po,withSetScope:ho,withSetIsolationScope:(e,t)=>Qt(t),getCurrentScope:()=>Y().getScope(),getIsolationScope:()=>Y().getIsolationScope()}}function gt(e){const t=ve(e);return t.acs?t.acs:go()}function L(){const e=ke();return gt(e).getCurrentScope()}function ie(){const e=ke();return gt(e).getIsolationScope()}function mo(){return re("globalScope",()=>new N)}function _o(...e){const t=ke(),n=gt(t);if(e.length===2){const[r,o]=e;return r?n.withSetScope(r,o):n.withScope(o)}return n.withScope(e[0])}function S(){return L().getClient()}function Eo(e){const t=e.getPropagationContext(),{traceId:n,parentSpanId:r,propagationSpanId:o}=t,s={trace_id:n,span_id:o||Rn()};return r&&(s.parent_span_id=r),s}const yo="sentry.source",Ao="sentry.sample_rate",bo="sentry.previous_trace_sample_rate",So="sentry.op",wo="sentry.origin",Cn="sentry.profile_id",Nn="sentry.exclusive_time",To=0,Bo=1,Io="_sentryScope",ko="_sentryIsolationScope";function xn(e){return{scope:e[Io],isolationScope:e[ko]}}const vo="sentry-",Do=/^sentry-/;function Ro(e){const t=Co(e);if(!t)return;const n=Object.entries(t).reduce((r,[o,s])=>{if(o.match(Do)){const i=o.slice(vo.length);r[i]=s}return r},{});if(Object.keys(n).length>0)return n}function Co(e){if(!(!e||!R(e)&&!Array.isArray(e)))return Array.isArray(e)?e.reduce((t,n)=>{const r=Lt(n);return Object.entries(r).forEach(([o,s])=>{t[o]=s}),t},{}):Lt(e)}function Lt(e){return e.split(",").map(t=>t.split("=").map(n=>{try{return decodeURIComponent(n.trim())}catch{return}})).reduce((t,[n,r])=>(n&&r&&(t[n]=r),t),{})}function No(e){if(typeof e=="boolean")return Number(e);const t=typeof e=="string"?parseFloat(e):e;if(!(typeof t!="number"||isNaN(t)||t<0||t>1))return t}const Fn=1;let Mt=!1;function xo(e){const{spanId:t,traceId:n,isRemote:r}=e.spanContext(),o=r?t:mt(e).parent_span_id,s=xn(e).scope,i=r?(s==null?void 0:s.getPropagationContext().propagationSpanId)||Rn():t;return{parent_span_id:o,span_id:i,trace_id:n}}function Fo(e){if(e&&e.length>0)return e.map(({context:{spanId:t,traceId:n,traceFlags:r,...o},attributes:s})=>({span_id:t,trace_id:n,sampled:r===Fn,attributes:s,...o}))}function Pt(e){return typeof e=="number"?Ot(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?Ot(e.getTime()):C()}function Ot(e){return e>9999999999?e/1e3:e}function mt(e){var r;if(Lo(e))return e.getSpanJSON();const{spanId:t,traceId:n}=e.spanContext();if(Qo(e)){const{attributes:o,startTime:s,name:i,endTime:a,status:c,links:u}=e,l="parentSpanId"in e?e.parentSpanId:"parentSpanContext"in e?(r=e.parentSpanContext)==null?void 0:r.spanId:void 0;return{span_id:t,trace_id:n,data:o,description:i,parent_span_id:l,start_timestamp:Pt(s),timestamp:Pt(a)||void 0,status:Po(c),op:o[So],origin:o[wo],links:Fo(u)}}return{span_id:t,trace_id:n,start_timestamp:0,data:{}}}function Qo(e){const t=e;return!!t.attributes&&!!t.startTime&&!!t.name&&!!t.endTime&&!!t.status}function Lo(e){return typeof e.getSpanJSON=="function"}function Mo(e){const{traceFlags:t}=e.spanContext();return t===Fn}function Po(e){if(!(!e||e.code===To))return e.code===Bo?"ok":e.message||"unknown_error"}const Oo="_sentryRootSpan";function Qn(e){return e[Oo]||e}function Ut(){Mt||(X(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.")}),Mt=!0)}function Uo(e){var n;if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const t=e||((n=S())==null?void 0:n.getOptions());return!!t&&(t.tracesSampleRate!=null||!!t.tracesSampler)}const _t="production",$o=/^o(\d+)\./,Ho=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Go(e){return e==="http"||e==="https"}function Ne(e,t=!1){const{host:n,path:r,pass:o,port:s,projectId:i,protocol:a,publicKey:c}=e;return`${a}://${c}${t&&o?`:${o}`:""}@${n}${s?`:${s}`:""}/${r&&`${r}/`}${i}`}function Wo(e){const t=Ho.exec(e);if(!t){X(()=>{console.error(`Invalid Sentry Dsn: ${e}`)});return}const[n,r,o="",s="",i="",a=""]=t.slice(1);let c="",u=a;const l=u.split("/");if(l.length>1&&(c=l.slice(0,-1).join("/"),u=l.pop()),u){const f=u.match(/^\d+/);f&&(u=f[0])}return Ln({host:s,pass:o,path:c,projectId:u,port:i,protocol:n,publicKey:r})}function Ln(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function jo(e){if(!g)return!0;const{port:t,projectId:n,protocol:r}=e;return["protocol","publicKey","host","projectId"].find(i=>e[i]?!1:(p.error(`Invalid Sentry Dsn: ${i} missing`),!0))?!1:n.match(/^\d+$/)?Go(r)?t&&isNaN(parseInt(t,10))?(p.error(`Invalid Sentry Dsn: Invalid port ${t}`),!1):!0:(p.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(p.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function Vo(e){const t=e.match($o);return t==null?void 0:t[1]}function Yo(e){const t=typeof e=="string"?Wo(e):Ln(e);if(!(!t||!jo(t)))return t}const zo="_frozenDsc";function Mn(e,t){const n=t.getOptions(),{publicKey:r,host:o}=t.getDsn()||{};let s;n.orgId?s=String(n.orgId):o&&(s=Vo(o));const i={environment:n.environment||_t,release:n.release,public_key:r,trace_id:e,org_id:s};return t.emit("createDsc",i),i}function Xo(e,t){const n=t.getPropagationContext();return n.dsc||Mn(n.traceId,e)}function Jo(e){var y;const t=S();if(!t)return{};const n=Qn(e),r=mt(n),o=r.data,s=n.spanContext().traceState,i=(s==null?void 0:s.get("sentry.sample_rate"))??o[Ao]??o[bo];function a(T){return(typeof i=="number"||typeof i=="string")&&(T.sample_rate=`${i}`),T}const c=n[zo];if(c)return a(c);const u=s==null?void 0:s.get("sentry.dsc"),l=u&&Ro(u);if(l)return a(l);const f=Mn(e.spanContext().traceId,t),h=o[yo],d=r.description;return h!=="url"&&d&&(f.transaction=d),Uo()&&(f.sampled=String(Mo(n)),f.sample_rand=(s==null?void 0:s.get("sentry.sample_rand"))??((y=xn(n).scope)==null?void 0:y.getPropagationContext().sampleRand.toString())),a(f),t.emit("createDsc",f,n),f}function D(e,t=100,n=1/0){try{return Ve("",e,t,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function Pn(e,t=3,n=100*1024){const r=D(e,t);return es(r)>n?Pn(e,t-1,n):r}function Ve(e,t,n=1/0,r=1/0,o=ts()){const[s,i]=o;if(t==null||["boolean","string"].includes(typeof t)||typeof t=="number"&&Number.isFinite(t))return t;const a=qo(e,t);if(!a.startsWith("[object "))return a;if(t.__sentry_skip_normalization__)return t;const c=typeof t.__sentry_override_normalization_depth__=="number"?t.__sentry_override_normalization_depth__:n;if(c===0)return a.replace("object ","");if(s(t))return"[Circular ~]";const u=t;if(u&&typeof u.toJSON=="function")try{const d=u.toJSON();return Ve("",d,c-1,r,o)}catch{}const l=Array.isArray(t)?[]:{};let f=0;const h=kn(t);for(const d in h){if(!Object.prototype.hasOwnProperty.call(h,d))continue;if(f>=r){l[d]="[MaxProperties ~]";break}const y=h[d];l[d]=Ve(d,y,c-1,r,o),f++}return i(t),l}function qo(e,t){try{if(e==="domain"&&t&&typeof t=="object"&&t._events)return"[Domain]";if(e==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&t===global)return"[Global]";if(typeof window<"u"&&t===window)return"[Window]";if(typeof document<"u"&&t===document)return"[Document]";if(Tn(t))return"[VueViewModel]";if(Xr(t))return"[SyntheticEvent]";if(typeof t=="number"&&!Number.isFinite(t))return`[${t}]`;if(typeof t=="function")return`[Function: ${x(t)}]`;if(typeof t=="symbol")return`[${String(t)}]`;if(typeof t=="bigint")return`[BigInt: ${String(t)}]`;const n=Ko(t);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function Ko(e){const t=Object.getPrototypeOf(e);return t!=null&&t.constructor?t.constructor.name:"null prototype"}function Zo(e){return~-encodeURI(e).split(/%..|./).length}function es(e){return Zo(JSON.stringify(e))}function ts(){const e=new WeakSet;function t(r){return e.has(r)?!0:(e.add(r),!1)}function n(r){e.delete(r)}return[t,n]}function ae(e,t=[]){return[e,t]}function ns(e,t){const[n,r]=e;return[n,[...r,t]]}function $t(e,t){const n=e[1];for(const r of n){const o=r[0].type;if(t(r,o))return!0}return!1}function Ye(e){const t=ve(m);return t.encodePolyfill?t.encodePolyfill(e):new TextEncoder().encode(e)}function rs(e){const[t,n]=e;let r=JSON.stringify(t);function o(s){typeof r=="string"?r=typeof s=="string"?r+s:[Ye(r),s]:r.push(typeof s=="string"?Ye(s):s)}for(const s of n){const[i,a]=s;if(o(`
${JSON.stringify(i)}
`),typeof a=="string"||a instanceof Uint8Array)o(a);else{let c;try{c=JSON.stringify(a)}catch{c=JSON.stringify(D(a))}o(c)}}return typeof r=="string"?r:os(r)}function os(e){const t=e.reduce((o,s)=>o+s.length,0),n=new Uint8Array(t);let r=0;for(const o of e)n.set(o,r),r+=o.length;return n}function ss(e){const t=typeof e.data=="string"?Ye(e.data):e.data;return[{type:"attachment",length:t.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType},t]}const is={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item"};function Ht(e){return is[e]}function On(e){if(!(e!=null&&e.sdk))return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}function as(e,t,n,r){var s;const o=(s=e.sdkProcessingMetadata)==null?void 0:s.dynamicSamplingContext;return{event_id:e.event_id,sent_at:new Date().toISOString(),...t&&{sdk:t},...!!n&&r&&{dsn:Ne(r)},...o&&{trace:o}}}function cs(e,t){return t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]]),e}function us(e,t,n,r){const o=On(n),s={sent_at:new Date().toISOString(),...o&&{sdk:o},...!!r&&t&&{dsn:Ne(t)}},i="aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()];return ae(s,[i])}function ls(e,t,n,r){const o=On(n),s=e.type&&e.type!=="replay_event"?e.type:"event";cs(e,n==null?void 0:n.sdk);const i=as(e,o,r,t);return delete e.sdkProcessingMetadata,ae(i,[[{type:s},e]])}const Oe=0,Gt=1,Wt=2;function $(e){return new Q(t=>{t(e)})}function we(e){return new Q((t,n)=>{n(e)})}class Q{constructor(t){this._state=Oe,this._handlers=[],this._runExecutor(t)}then(t,n){return new Q((r,o)=>{this._handlers.push([!1,s=>{if(!t)r(s);else try{r(t(s))}catch(i){o(i)}},s=>{if(!n)o(s);else try{r(n(s))}catch(i){o(i)}}]),this._executeHandlers()})}catch(t){return this.then(n=>n,t)}finally(t){return new Q((n,r)=>{let o,s;return this.then(i=>{s=!1,o=i,t&&t()},i=>{s=!0,o=i,t&&t()}).then(()=>{if(s){r(o);return}n(o)})})}_executeHandlers(){if(this._state===Oe)return;const t=this._handlers.slice();this._handlers=[],t.forEach(n=>{n[0]||(this._state===Gt&&n[1](this._value),this._state===Wt&&n[2](this._value),n[0]=!0)})}_runExecutor(t){const n=(s,i)=>{if(this._state===Oe){if(Re(i)){i.then(r,o);return}this._state=s,this._value=i,this._executeHandlers()}},r=s=>{n(Gt,s)},o=s=>{n(Wt,s)};try{t(r,o)}catch(s){o(s)}}}function ze(e,t,n,r=0){return new Q((o,s)=>{const i=e[r];if(t===null||typeof i!="function")o(t);else{const a=i({...t},n);g&&i.id&&a===null&&p.log(`Event processor "${i.id}" dropped event`),Re(a)?a.then(c=>ze(e,c,n,r+1).then(o)).then(null,s):ze(e,a,n,r+1).then(o).then(null,s)}})}function fs(e,t){const{fingerprint:n,span:r,breadcrumbs:o,sdkProcessingMetadata:s}=t;ds(e,t),r&&gs(e,r),ms(e,n),ps(e,o),hs(e,s)}function jt(e,t){const{extra:n,tags:r,user:o,contexts:s,level:i,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:u,eventProcessors:l,attachments:f,propagationContext:h,transactionName:d,span:y}=t;fe(e,"extra",n),fe(e,"tags",r),fe(e,"user",o),fe(e,"contexts",s),e.sdkProcessingMetadata=se(e.sdkProcessingMetadata,a,2),i&&(e.level=i),d&&(e.transactionName=d),y&&(e.span=y),c.length&&(e.breadcrumbs=[...e.breadcrumbs,...c]),u.length&&(e.fingerprint=[...e.fingerprint,...u]),l.length&&(e.eventProcessors=[...e.eventProcessors,...l]),f.length&&(e.attachments=[...e.attachments,...f]),e.propagationContext={...e.propagationContext,...h}}function fe(e,t,n){e[t]=se(e[t],n,1)}function ds(e,t){const{extra:n,tags:r,user:o,contexts:s,level:i,transactionName:a}=t;Object.keys(n).length&&(e.extra={...n,...e.extra}),Object.keys(r).length&&(e.tags={...r,...e.tags}),Object.keys(o).length&&(e.user={...o,...e.user}),Object.keys(s).length&&(e.contexts={...s,...e.contexts}),i&&(e.level=i),a&&e.type!=="transaction"&&(e.transaction=a)}function ps(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}function hs(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}function gs(e,t){e.contexts={trace:xo(t),...e.contexts},e.sdkProcessingMetadata={dynamicSamplingContext:Jo(t),...e.sdkProcessingMetadata};const n=Qn(t),r=mt(n).description;r&&!e.transaction&&e.type==="transaction"&&(e.transaction=r)}function ms(e,t){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],t&&(e.fingerprint=e.fingerprint.concat(t)),e.fingerprint.length||delete e.fingerprint}let de,Vt,pe;function _s(e){const t=m._sentryDebugIds;if(!t)return{};const n=Object.keys(t);return pe&&n.length===Vt||(Vt=n.length,pe=n.reduce((r,o)=>{de||(de={});const s=de[o];if(s)r[s[0]]=s[1];else{const i=e(o);for(let a=i.length-1;a>=0;a--){const c=i[a],u=c==null?void 0:c.filename,l=t[o];if(u&&l){r[u]=l,de[o]=[u,l];break}}}return r},{})),pe}function Es(e,t,n,r,o,s){const{normalizeDepth:i=3,normalizeMaxBreadth:a=1e3}=e,c={...t,event_id:t.event_id||n.event_id||I(),timestamp:t.timestamp||oe()},u=n.integrations||e.integrations.map(A=>A.name);ys(c,e),Ss(c,u),o&&o.emit("applyFrameMetadata",t),t.type===void 0&&As(c,e.stackParser);const l=Ts(r,n.captureContext);n.mechanism&&j(c,n.mechanism);const f=o?o.getEventProcessors():[],h=mo().getScopeData();if(s){const A=s.getScopeData();jt(h,A)}if(l){const A=l.getScopeData();jt(h,A)}const d=[...n.attachments||[],...h.attachments];d.length&&(n.attachments=d),fs(c,h);const y=[...f,...h.eventProcessors];return ze(y,c,n).then(A=>(A&&bs(A),typeof i=="number"&&i>0?ws(A,i,a):A))}function ys(e,t){const{environment:n,release:r,dist:o,maxValueLength:s=250}=t;e.environment=e.environment||n||_t,!e.release&&r&&(e.release=r),!e.dist&&o&&(e.dist=o);const i=e.request;i!=null&&i.url&&(i.url=Se(i.url,s))}function As(e,t){var r,o;const n=_s(t);(o=(r=e.exception)==null?void 0:r.values)==null||o.forEach(s=>{var i,a;(a=(i=s.stacktrace)==null?void 0:i.frames)==null||a.forEach(c=>{c.filename&&(c.debug_id=n[c.filename])})})}function bs(e){var r,o;const t={};if((o=(r=e.exception)==null?void 0:r.values)==null||o.forEach(s=>{var i,a;(a=(i=s.stacktrace)==null?void 0:i.frames)==null||a.forEach(c=>{c.debug_id&&(c.abs_path?t[c.abs_path]=c.debug_id:c.filename&&(t[c.filename]=c.debug_id),delete c.debug_id)})}),Object.keys(t).length===0)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.entries(t).forEach(([s,i])=>{n.push({type:"sourcemap",code_file:s,debug_id:i})})}function Ss(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}function ws(e,t,n){var o,s;if(!e)return null;const r={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(i=>({...i,...i.data&&{data:D(i.data,t,n)}}))},...e.user&&{user:D(e.user,t,n)},...e.contexts&&{contexts:D(e.contexts,t,n)},...e.extra&&{extra:D(e.extra,t,n)}};return(o=e.contexts)!=null&&o.trace&&r.contexts&&(r.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(r.contexts.trace.data=D(e.contexts.trace.data,t,n))),e.spans&&(r.spans=e.spans.map(i=>({...i,...i.data&&{data:D(i.data,t,n)}}))),(s=e.contexts)!=null&&s.flags&&r.contexts&&(r.contexts.flags=D(e.contexts.flags,3,n)),r}function Ts(e,t){if(!t)return e;const n=e?e.clone():new N;return n.update(t),n}function Bs(e,t){return L().captureException(e,void 0)}function Un(e,t){return L().captureEvent(e,t)}function Yt(e){const t=ie(),n=L(),{userAgent:r}=m.navigator||{},o=so({user:n.getUser()||t.getUser(),...r&&{userAgent:r},...e}),s=t.getSession();return(s==null?void 0:s.status)==="ok"&&V(s,{status:"exited"}),$n(),t.setSession(o),o}function $n(){const e=ie(),n=L().getSession()||e.getSession();n&&io(n),Hn(),e.setSession()}function Hn(){const e=ie(),t=S(),n=e.getSession();n&&t&&t.captureSession(n)}function zt(e=!1){if(e){$n();return}Hn()}const Is="7";function ks(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function vs(e){return`${ks(e)}${e.projectId}/envelope/`}function Ds(e,t){const n={sentry_version:Is};return e.publicKey&&(n.sentry_key=e.publicKey),t&&(n.sentry_client=`${t.name}/${t.version}`),new URLSearchParams(n).toString()}function Rs(e,t,n){return t||`${vs(e)}?${Ds(e,n)}`}const Xt=[];function Cs(e){const t={};return e.forEach(n=>{const{name:r}=n,o=t[r];o&&!o.isDefaultInstance&&n.isDefaultInstance||(t[r]=n)}),Object.values(t)}function Ns(e){const t=e.defaultIntegrations||[],n=e.integrations;t.forEach(o=>{o.isDefaultInstance=!0});let r;if(Array.isArray(n))r=[...t,...n];else if(typeof n=="function"){const o=n(t);r=Array.isArray(o)?o:[o]}else r=t;return Cs(r)}function xs(e,t){const n={};return t.forEach(r=>{r&&Gn(e,r,n)}),n}function Jt(e,t){for(const n of t)n!=null&&n.afterAllSetup&&n.afterAllSetup(e)}function Gn(e,t,n){if(n[t.name]){g&&p.log(`Integration skipped because it was already installed: ${t.name}`);return}if(n[t.name]=t,Xt.indexOf(t.name)===-1&&typeof t.setupOnce=="function"&&(t.setupOnce(),Xt.push(t.name)),t.setup&&typeof t.setup=="function"&&t.setup(e),typeof t.preprocessEvent=="function"){const r=t.preprocessEvent.bind(t);e.on("preprocessEvent",(o,s)=>r(o,s,e))}if(typeof t.processEvent=="function"){const r=t.processEvent.bind(t),o=Object.assign((s,i)=>r(s,i,e),{id:t.name});e.addEventProcessor(o)}g&&p.log(`Integration installed: ${t.name}`)}function Fs(e,t,n){const r=[{type:"client_report"},{timestamp:oe(),discarded_events:e}];return ae(t?{dsn:t}:{},[r])}function Wn(e){const t=[];e.message&&t.push(e.message);try{const n=e.exception.values[e.exception.values.length-1];n!=null&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`))}catch{}return t}function Qs(e){var c;const{trace_id:t,parent_span_id:n,span_id:r,status:o,origin:s,data:i,op:a}=((c=e.contexts)==null?void 0:c.trace)??{};return{data:i??{},description:e.transaction,op:a,parent_span_id:n,span_id:r??"",start_timestamp:e.start_timestamp??0,status:o,timestamp:e.timestamp,trace_id:t??"",origin:s,profile_id:i==null?void 0:i[Cn],exclusive_time:i==null?void 0:i[Nn],measurements:e.measurements,is_segment:!0}}function Ls(e){return{type:"transaction",timestamp:e.timestamp,start_timestamp:e.start_timestamp,transaction:e.description,contexts:{trace:{trace_id:e.trace_id,span_id:e.span_id,parent_span_id:e.parent_span_id,op:e.op,status:e.status,origin:e.origin,data:{...e.data,...e.profile_id&&{[Cn]:e.profile_id},...e.exclusive_time&&{[Nn]:e.exclusive_time}}}},measurements:e.measurements}}const qt="Not capturing exception because it's already been captured.",Kt="Discarded session because of missing or non-string release",jn=Symbol.for("SentryInternalError"),Vn=Symbol.for("SentryDoNotSendEventError");function _e(e){return{message:e,[jn]:!0}}function Ue(e){return{message:e,[Vn]:!0}}function Zt(e){return!!e&&typeof e=="object"&&jn in e}function en(e){return!!e&&typeof e=="object"&&Vn in e}class Ms{constructor(t){if(this._options=t,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],t.dsn?this._dsn=Yo(t.dsn):g&&p.warn("No DSN provided, client will not send events."),this._dsn){const n=Rs(this._dsn,t.tunnel,t._metadata?t._metadata.sdk:void 0);this._transport=t.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...t.transportOptions,url:n})}}captureException(t,n,r){const o=I();if(Rt(t))return g&&p.log(qt),o;const s={event_id:o,...n};return this._process(this.eventFromException(t,s).then(i=>this._captureEvent(i,s,r))),s.event_id}captureMessage(t,n,r,o){const s={event_id:I(),...r},i=lt(t)?t:String(t),a=ft(t)?this.eventFromMessage(i,n,s):this.eventFromException(t,s);return this._process(a.then(c=>this._captureEvent(c,s,o))),s.event_id}captureEvent(t,n,r){const o=I();if(n!=null&&n.originalException&&Rt(n.originalException))return g&&p.log(qt),o;const s={event_id:o,...n},i=t.sdkProcessingMetadata||{},a=i.capturedSpanScope,c=i.capturedSpanIsolationScope;return this._process(this._captureEvent(t,s,a||r,c)),s.event_id}captureSession(t){this.sendSession(t),V(t,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(t){const n=this._transport;return n?(this.emit("flush"),this._isClientDoneProcessing(t).then(r=>n.flush(t).then(o=>r&&o))):$(!0)}close(t){return this.flush(t).then(n=>(this.getOptions().enabled=!1,this.emit("close"),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(t){this._eventProcessors.push(t)}init(){(this._isEnabled()||this._options.integrations.some(({name:t})=>t.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(t){return this._integrations[t]}addIntegration(t){const n=this._integrations[t.name];Gn(this,t,this._integrations),n||Jt(this,[t])}sendEvent(t,n={}){this.emit("beforeSendEvent",t,n);let r=ls(t,this._dsn,this._options._metadata,this._options.tunnel);for(const s of n.attachments||[])r=ns(r,ss(s));const o=this.sendEnvelope(r);o&&o.then(s=>this.emit("afterSendEvent",t,s),null)}sendSession(t){const{release:n,environment:r=_t}=this._options;if("aggregates"in t){const s=t.attrs||{};if(!s.release&&!n){g&&p.warn(Kt);return}s.release=s.release||n,s.environment=s.environment||r,t.attrs=s}else{if(!t.release&&!n){g&&p.warn(Kt);return}t.release=t.release||n,t.environment=t.environment||r}this.emit("beforeSendSession",t);const o=us(t,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(o)}recordDroppedEvent(t,n,r=1){if(this._options.sendClientReports){const o=`${t}:${n}`;g&&p.log(`Recording outcome: "${o}"${r>1?` (${r} times)`:""}`),this._outcomes[o]=(this._outcomes[o]||0)+r}}on(t,n){const r=this._hooks[t]=this._hooks[t]||[];return r.push(n),()=>{const o=r.indexOf(n);o>-1&&r.splice(o,1)}}emit(t,...n){const r=this._hooks[t];r&&r.forEach(o=>o(...n))}sendEnvelope(t){return this.emit("beforeEnvelope",t),this._isEnabled()&&this._transport?this._transport.send(t).then(null,n=>(g&&p.error("Error while sending envelope:",n),n)):(g&&p.error("Transport disabled"),$({}))}_setupIntegrations(){const{integrations:t}=this._options;this._integrations=xs(this,t),Jt(this,t)}_updateSessionFromEvent(t,n){var c;let r=n.level==="fatal",o=!1;const s=(c=n.exception)==null?void 0:c.values;if(s){o=!0;for(const u of s){const l=u.mechanism;if((l==null?void 0:l.handled)===!1){r=!0;break}}}const i=t.status==="ok";(i&&t.errors===0||i&&r)&&(V(t,{...r&&{status:"crashed"},errors:t.errors||Number(o||r)}),this.captureSession(t))}_isClientDoneProcessing(t){return new Q(n=>{let r=0;const o=1,s=setInterval(()=>{this._numProcessing==0?(clearInterval(s),n(!0)):(r+=o,t&&r>=t&&(clearInterval(s),n(!1)))},o)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(t,n,r,o){const s=this.getOptions(),i=Object.keys(this._integrations);return!n.integrations&&(i!=null&&i.length)&&(n.integrations=i),this.emit("preprocessEvent",t,n),t.type||o.setLastEventId(t.event_id||n.event_id),Es(s,t,n,r,this,o).then(a=>{if(a===null)return a;this.emit("postprocessEvent",a,n),a.contexts={trace:Eo(r),...a.contexts};const c=Xo(this,r);return a.sdkProcessingMetadata={dynamicSamplingContext:c,...a.sdkProcessingMetadata},a})}_captureEvent(t,n={},r=L(),o=ie()){return g&&Xe(t)&&p.log(`Captured error event \`${Wn(t)[0]||"<unknown>"}\``),this._processEvent(t,n,r,o).then(s=>s.event_id,s=>{g&&(en(s)?p.log(s.message):Zt(s)?p.warn(s.message):p.warn(s))})}_processEvent(t,n,r,o){const s=this.getOptions(),{sampleRate:i}=s,a=Yn(t),c=Xe(t),u=t.type||"error",l=`before send for type \`${u}\``,f=typeof i>"u"?void 0:No(i);if(c&&typeof f=="number"&&Math.random()>f)return this.recordDroppedEvent("sample_rate","error"),we(Ue(`Discarding event because it's not included in the random sample (sampling rate = ${i})`));const h=u==="replay_event"?"replay":u;return this._prepareEvent(t,n,r,o).then(d=>{if(d===null)throw this.recordDroppedEvent("event_processor",h),Ue("An event processor returned `null`, will not send event.");if(n.data&&n.data.__sentry__===!0)return d;const T=Os(this,s,d,n);return Ps(T,l)}).then(d=>{var A;if(d===null){if(this.recordDroppedEvent("before_send",h),a){const Fe=1+(t.spans||[]).length;this.recordDroppedEvent("before_send","span",Fe)}throw Ue(`${l} returned \`null\`, will not send event.`)}const y=r.getSession()||o.getSession();if(c&&y&&this._updateSessionFromEvent(y,d),a){const ce=((A=d.sdkProcessingMetadata)==null?void 0:A.spanCountBeforeProcessing)||0,Fe=d.spans?d.spans.length:0,bt=ce-Fe;bt>0&&this.recordDroppedEvent("before_send","span",bt)}const T=d.transaction_info;if(a&&T&&d.transaction!==t.transaction){const ce="custom";d.transaction_info={...T,source:ce}}return this.sendEvent(d,n),d}).then(null,d=>{throw en(d)||Zt(d)?d:(this.captureException(d,{data:{__sentry__:!0},originalException:d}),_e(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${d}`))})}_process(t){this._numProcessing++,t.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_clearOutcomes(){const t=this._outcomes;return this._outcomes={},Object.entries(t).map(([n,r])=>{const[o,s]=n.split(":");return{reason:o,category:s,quantity:r}})}_flushOutcomes(){g&&p.log("Flushing outcomes...");const t=this._clearOutcomes();if(t.length===0){g&&p.log("No outcomes to send");return}if(!this._dsn){g&&p.log("No dsn provided, will not send outcomes");return}g&&p.log("Sending outcomes:",t);const n=Fs(t,this._options.tunnel&&Ne(this._dsn));this.sendEnvelope(n)}}function Ps(e,t){const n=`${t} must return \`null\` or a valid event.`;if(Re(e))return e.then(r=>{if(!te(r)&&r!==null)throw _e(n);return r},r=>{throw _e(`${t} rejected with ${r}`)});if(!te(e)&&e!==null)throw _e(n);return e}function Os(e,t,n,r){const{beforeSend:o,beforeSendTransaction:s,beforeSendSpan:i}=t;let a=n;if(Xe(a)&&o)return o(a,r);if(Yn(a)){if(i){const c=i(Qs(a));if(c?a=se(n,Ls(c)):Ut(),a.spans){const u=[];for(const l of a.spans){const f=i(l);f?u.push(f):(Ut(),u.push(l))}a.spans=u}}if(s){if(a.spans){const c=a.spans.length;a.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:c}}return s(a,r)}}return a}function Xe(e){return e.type===void 0}function Yn(e){return e.type==="transaction"}function Us(e){return[{type:"log",item_count:e.length,content_type:"application/vnd.sentry.items.log+json"},{items:e}]}function $s(e,t,n,r){const o={};return t!=null&&t.sdk&&(o.sdk={name:t.sdk.name,version:t.sdk.version}),n&&r&&(o.dsn=Ne(r)),ae(o,[Us(e)])}function $e(e,t){const n=Hs(e)??[];if(n.length===0)return;const r=e.getOptions(),o=$s(n,r._metadata,r.tunnel,e.getDsn());zn().set(e,[]),e.emit("flushLogs"),e.sendEnvelope(o)}function Hs(e){return zn().get(e)}function zn(){return re("clientToLogBufferMap",()=>new WeakMap)}function Gs(e,t){t.debug===!0&&(g?p.enable():X(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),L().update(t.initialScope);const r=new e(t);return Ws(r),r.init(),r}function Ws(e){L().setClient(e)}const Xn=Symbol.for("SentryBufferFullError");function js(e){const t=[];function n(){return e===void 0||t.length<e}function r(i){return t.splice(t.indexOf(i),1)[0]||Promise.resolve(void 0)}function o(i){if(!n())return we(Xn);const a=i();return t.indexOf(a)===-1&&t.push(a),a.then(()=>r(a)).then(null,()=>r(a).then(null,()=>{})),a}function s(i){return new Q((a,c)=>{let u=t.length;if(!u)return a(!0);const l=setTimeout(()=>{i&&i>0&&a(!1)},i);t.forEach(f=>{$(f).then(()=>{--u||(clearTimeout(l),a(!0))},c)})})}return{$:t,add:o,drain:s}}const Vs=60*1e3;function Ys(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return n*1e3;const r=Date.parse(`${e}`);return isNaN(r)?Vs:r-t}function zs(e,t){return e[t]||e.all||0}function Xs(e,t,n=Date.now()){return zs(e,t)>n}function Js(e,{statusCode:t,headers:n},r=Date.now()){const o={...e},s=n==null?void 0:n["x-sentry-rate-limits"],i=n==null?void 0:n["retry-after"];if(s)for(const a of s.trim().split(",")){const[c,u,,,l]=a.split(":",5),f=parseInt(c,10),h=(isNaN(f)?60:f)*1e3;if(!u)o.all=r+h;else for(const d of u.split(";"))d==="metric_bucket"?(!l||l.split(";").includes("custom"))&&(o[d]=r+h):o[d]=r+h}else i?o.all=r+Ys(i,r):t===429&&(o.all=r+60*1e3);return o}const qs=64;function Ks(e,t,n=js(e.bufferSize||qs)){let r={};const o=i=>n.drain(i);function s(i){const a=[];if($t(i,(f,h)=>{const d=Ht(h);Xs(r,d)?e.recordDroppedEvent("ratelimit_backoff",d):a.push(f)}),a.length===0)return $({});const c=ae(i[0],a),u=f=>{$t(c,(h,d)=>{e.recordDroppedEvent(f,Ht(d))})},l=()=>t({body:rs(c)}).then(f=>(f.statusCode!==void 0&&(f.statusCode<200||f.statusCode>=300)&&g&&p.warn(`Sentry responded with status code ${f.statusCode} to sent event.`),r=Js(r,f),f),f=>{throw u("network_error"),g&&p.error("Encountered error running transport request:",f),f});return n.add(l).then(f=>f,f=>{if(f===Xn)return g&&p.error("Skipped sending event because buffer is full."),u("queue_overflow"),$({});throw f})}return{send:s,flush:o}}function Zs(e){var t;((t=e.user)==null?void 0:t.ip_address)===void 0&&(e.user={...e.user,ip_address:"{{auto}}"})}function ei(e){var t;"aggregates"in e?((t=e.attrs)==null?void 0:t.ip_address)===void 0&&(e.attrs={...e.attrs,ip_address:"{{auto}}"}):e.ipAddress===void 0&&(e.ipAddress="{{auto}}")}function ti(e,t,n=[t],r="npm"){const o=e._metadata||{};o.sdk||(o.sdk={name:`sentry.javascript.${t}`,packages:n.map(s=>({name:`${r}:@sentry/${s}`,version:P})),version:P}),e._metadata=o}const ni=100;function H(e,t){const n=S(),r=ie();if(!n)return;const{beforeBreadcrumb:o=null,maxBreadcrumbs:s=ni}=n.getOptions();if(s<=0)return;const a={timestamp:oe(),...e},c=o?X(()=>o(a,t)):a;c!==null&&(n.emit&&n.emit("beforeAddBreadcrumb",c,t),r.addBreadcrumb(c,s))}let tn;const ri="FunctionToString",nn=new WeakMap,oi=(()=>({name:ri,setupOnce(){tn=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=ht(this),n=nn.has(S())&&t!==void 0?t:this;return tn.apply(n,e)}}catch{}},setup(e){nn.set(e,!0)}})),si=oi,ii=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,/^Can't find variable: gmo$/,/^undefined is not an object \(evaluating 'a\.[A-Z]'\)$/,`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/,/^Java exception was raised during method invocation$/],ai="EventFilters",ci=(e={})=>{let t;return{name:ai,setup(n){const r=n.getOptions();t=rn(e,r)},processEvent(n,r,o){if(!t){const s=o.getOptions();t=rn(e,s)}return li(n,t)?null:n}}},ui=((e={})=>({...ci(e),name:"InboundFilters"}));function rn(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:ii],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[]]}}function li(e,t){if(e.type){if(e.type==="transaction"&&di(e,t.ignoreTransactions))return g&&p.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${M(e)}`),!0}else{if(fi(e,t.ignoreErrors))return g&&p.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${M(e)}`),!0;if(mi(e))return g&&p.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${M(e)}`),!0;if(pi(e,t.denyUrls))return g&&p.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${M(e)}.
Url: ${Te(e)}`),!0;if(!hi(e,t.allowUrls))return g&&p.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${M(e)}.
Url: ${Te(e)}`),!0}return!1}function fi(e,t){return t!=null&&t.length?Wn(e).some(n=>Ce(n,t)):!1}function di(e,t){if(!(t!=null&&t.length))return!1;const n=e.transaction;return n?Ce(n,t):!1}function pi(e,t){if(!(t!=null&&t.length))return!1;const n=Te(e);return n?Ce(n,t):!1}function hi(e,t){if(!(t!=null&&t.length))return!0;const n=Te(e);return n?Ce(n,t):!0}function gi(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function Te(e){var t,n;try{const r=[...((t=e.exception)==null?void 0:t.values)??[]].reverse().find(s=>{var i,a,c;return((i=s.mechanism)==null?void 0:i.parent_id)===void 0&&((c=(a=s.stacktrace)==null?void 0:a.frames)==null?void 0:c.length)}),o=(n=r==null?void 0:r.stacktrace)==null?void 0:n.frames;return o?gi(o):null}catch{return g&&p.error(`Cannot extract url for event ${M(e)}`),null}}function mi(e){var t,n;return(n=(t=e.exception)==null?void 0:t.values)!=null&&n.length?!e.message&&!e.exception.values.some(r=>r.stacktrace||r.type&&r.type!=="Error"||r.value):!1}function _i(e,t,n,r,o,s){var a;if(!((a=o.exception)!=null&&a.values)||!s||!F(s.originalException,Error))return;const i=o.exception.values.length>0?o.exception.values[o.exception.values.length-1]:void 0;i&&(o.exception.values=Je(e,t,r,s.originalException,n,o.exception.values,i,0))}function Je(e,t,n,r,o,s,i,a){if(s.length>=n+1)return s;let c=[...s];if(F(r[o],Error)){on(i,a);const u=e(t,r[o]),l=c.length;sn(u,o,l,a),c=Je(e,t,n,r[o],o,[u,...c],u,l)}return Array.isArray(r.errors)&&r.errors.forEach((u,l)=>{if(F(u,Error)){on(i,a);const f=e(t,u),h=c.length;sn(f,`errors[${l}]`,h,a),c=Je(e,t,n,u,o,[f,...c],f,h)}}),c}function on(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,...e.type==="AggregateError"&&{is_exception_group:!0},exception_id:t}}function sn(e,t,n,r){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:r}}function Ei(e){const t="console";G(t,e),W(t,yi)}function yi(){"console"in m&&xr.forEach(function(e){e in m.console&&w(m.console,e,function(t){return be[e]=t,function(...n){k("console",{args:n,level:e});const o=be[e];o==null||o.apply(m.console,n)}})})}function Ai(e){return e==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(e)?e:"log"}const bi="Dedupe",Si=(()=>{let e;return{name:bi,processEvent(t){if(t.type)return t;try{if(Ti(t,e))return g&&p.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return e=t}}}),wi=Si;function Ti(e,t){return t?!!(Bi(e,t)||Ii(e,t)):!1}function Bi(e,t){const n=e.message,r=t.message;return!(!n&&!r||n&&!r||!n&&r||n!==r||!qn(e,t)||!Jn(e,t))}function Ii(e,t){const n=an(t),r=an(e);return!(!n||!r||n.type!==r.type||n.value!==r.value||!qn(e,t)||!Jn(e,t))}function Jn(e,t){let n=Tt(e),r=Tt(t);if(!n&&!r)return!0;if(n&&!r||!n&&r||(n=n,r=r,r.length!==n.length))return!1;for(let o=0;o<r.length;o++){const s=r[o],i=n[o];if(s.filename!==i.filename||s.lineno!==i.lineno||s.colno!==i.colno||s.function!==i.function)return!1}return!0}function qn(e,t){let n=e.fingerprint,r=t.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;n=n,r=r;try{return n.join("")===r.join("")}catch{return!1}}function an(e){var t,n;return(n=(t=e.exception)==null?void 0:t.values)==null?void 0:n[0]}function He(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:r,relative:t[5]+n+r}}function Kn(e){if(e!==void 0)return e>=400&&e<500?"warning":e>=500?"error":void 0}const ne=m;function ki(){return"history"in ne&&!!ne.history}function vi(){if(!("fetch"in ne))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function qe(e){return e&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function Di(){var n;if(typeof EdgeRuntime=="string")return!0;if(!vi())return!1;if(qe(ne.fetch))return!0;let e=!1;const t=ne.document;if(t&&typeof t.createElement=="function")try{const r=t.createElement("iframe");r.hidden=!0,t.head.appendChild(r),(n=r.contentWindow)!=null&&n.fetch&&(e=qe(r.contentWindow.fetch)),t.head.removeChild(r)}catch(r){g&&p.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",r)}return e}function Ri(e,t){const n="fetch";G(n,e),W(n,()=>Ci(void 0,t))}function Ci(e,t=!1){t&&!Di()||w(m,"fetch",function(n){return function(...r){const o=new Error,{method:s,url:i}=Ni(r),a={args:r,fetchData:{method:s,url:i},startTimestamp:C()*1e3,virtualError:o,headers:xi(r)};return k("fetch",{...a}),n.apply(m,r).then(async c=>(k("fetch",{...a,endTimestamp:C()*1e3,response:c}),c),c=>{if(k("fetch",{...a,endTimestamp:C()*1e3,error:c}),ut(c)&&c.stack===void 0&&(c.stack=o.stack,U(c,"framesToPop",1)),c instanceof TypeError&&(c.message==="Failed to fetch"||c.message==="Load failed"||c.message==="NetworkError when attempting to fetch resource."))try{const u=new URL(a.fetchData.url);c.message=`${c.message} (${u.host})`}catch{}throw c})}})}function Ke(e,t){return!!e&&typeof e=="object"&&!!e[t]}function cn(e){return typeof e=="string"?e:e?Ke(e,"url")?e.url:e.toString?e.toString():"":""}function Ni(e){if(e.length===0)return{method:"GET",url:""};if(e.length===2){const[n,r]=e;return{url:cn(n),method:Ke(r,"method")?String(r.method).toUpperCase():"GET"}}const t=e[0];return{url:cn(t),method:Ke(t,"method")?String(t.method).toUpperCase():"GET"}}function xi(e){const[t,n]=e;try{if(typeof n=="object"&&n!==null&&"headers"in n&&n.headers)return new Headers(n.headers);if(Jr(t))return new Headers(t.headers)}catch{}}function Fi(){return"npm"}const E=m;let Ze=0;function Zn(){return Ze>0}function Qi(){Ze++,setTimeout(()=>{Ze--})}function z(e,t={}){function n(o){return typeof o=="function"}if(!n(e))return e;try{const o=e.__sentry_wrapped__;if(o)return typeof o=="function"?o:e;if(ht(e))return e}catch{return e}const r=function(...o){try{const s=o.map(i=>z(i,t));return e.apply(this,s)}catch(s){throw Qi(),_o(i=>{i.addEventProcessor(a=>(t.mechanism&&(We(a,void 0),j(a,t.mechanism)),a.extra={...a.extra,arguments:o},a)),Bs(s)}),s}};try{for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o])}catch{}In(r,e),U(e,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get(){return e.name}})}catch{}return r}function Li(){const e=pt(),{referrer:t}=E.document||{},{userAgent:n}=E.navigator||{},r={...t&&{Referer:t},...n&&{"User-Agent":n}};return{url:e,headers:r}}function Et(e,t){const n=yt(e,t),r={type:$i(t),value:Hi(t)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function Mi(e,t,n,r){const o=S(),s=o==null?void 0:o.getOptions().normalizeDepth,i=Yi(t),a={__serialized__:Pn(t,s)};if(i)return{exception:{values:[Et(e,i)]},extra:a};const c={exception:{values:[{type:De(t)?t.constructor.name:r?"UnhandledRejection":"Error",value:ji(t,{isUnhandledRejection:r})}]},extra:a};if(n){const u=yt(e,n);u.length&&(c.exception.values[0].stacktrace={frames:u})}return c}function Ge(e,t){return{exception:{values:[Et(e,t)]}}}function yt(e,t){const n=t.stacktrace||t.stack||"",r=Oi(t),o=Ui(t);try{return e(n,r,o)}catch{}return[]}const Pi=/Minified React error #\d+;/i;function Oi(e){return e&&Pi.test(e.message)?1:0}function Ui(e){return typeof e.framesToPop=="number"?e.framesToPop:0}function er(e){return typeof WebAssembly<"u"&&typeof WebAssembly.Exception<"u"?e instanceof WebAssembly.Exception:!1}function $i(e){const t=e==null?void 0:e.name;return!t&&er(e)?e.message&&Array.isArray(e.message)&&e.message.length==2?e.message[0]:"WebAssembly.Exception":t}function Hi(e){const t=e==null?void 0:e.message;return er(e)?Array.isArray(e.message)&&e.message.length==2?e.message[1]:"wasm exception":t?t.error&&typeof t.error.message=="string"?t.error.message:t:"No error message"}function Gi(e,t,n,r){const o=(n==null?void 0:n.syntheticException)||void 0,s=At(e,t,o,r);return j(s),s.level="error",n!=null&&n.event_id&&(s.event_id=n.event_id),$(s)}function Wi(e,t,n="info",r,o){const s=(r==null?void 0:r.syntheticException)||void 0,i=et(e,t,s,o);return i.level=n,r!=null&&r.event_id&&(i.event_id=r.event_id),$(i)}function At(e,t,n,r,o){let s;if(wn(t)&&t.error)return Ge(e,t.error);if(It(t)||Vr(t)){const i=t;if("stack"in t)s=Ge(e,t);else{const a=i.name||(It(i)?"DOMError":"DOMException"),c=i.message?`${a}: ${i.message}`:a;s=et(e,c,n,r),We(s,c)}return"code"in i&&(s.tags={...s.tags,"DOMException.code":`${i.code}`}),s}return ut(t)?Ge(e,t):te(t)||De(t)?(s=Mi(e,t,n,o),j(s,{synthetic:!0}),s):(s=et(e,t,n,r),We(s,`${t}`),j(s,{synthetic:!0}),s)}function et(e,t,n,r){const o={};if(r&&n){const s=yt(e,n);s.length&&(o.exception={values:[{value:t,stacktrace:{frames:s}}]}),j(o,{synthetic:!0})}if(lt(t)){const{__sentry_template_string__:s,__sentry_template_values__:i}=t;return o.logentry={message:s,params:i},o}return o.message=t,o}function ji(e,{isUnhandledRejection:t}){const n=to(e),r=t?"promise rejection":"exception";return wn(e)?`Event \`ErrorEvent\` captured as ${r} with message \`${e.message}\``:De(e)?`Event \`${Vi(e)}\` (type=${e.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}function Vi(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{}}function Yi(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];if(n instanceof Error)return n}}const zi=5e3;class Xi extends Ms{constructor(t){const n=Ji(t),r=E.SENTRY_SDK_SOURCE||Fi();ti(n,"browser",["browser"],r),super(n);const{sendDefaultPii:o,sendClientReports:s,enableLogs:i,_experiments:a}=this._options,c=i??(a==null?void 0:a.enableLogs);E.document&&(s||c)&&E.document.addEventListener("visibilitychange",()=>{E.document.visibilityState==="hidden"&&(s&&this._flushOutcomes(),c&&$e(this))}),c&&(this.on("flush",()=>{$e(this)}),this.on("afterCaptureLog",()=>{this._logFlushIdleTimeout&&clearTimeout(this._logFlushIdleTimeout),this._logFlushIdleTimeout=setTimeout(()=>{$e(this)},zi)})),o&&(this.on("postprocessEvent",Zs),this.on("beforeSendSession",ei))}eventFromException(t,n){return Gi(this._options.stackParser,t,n,this._options.attachStacktrace)}eventFromMessage(t,n="info",r){return Wi(this._options.stackParser,t,n,r,this._options.attachStacktrace)}_prepareEvent(t,n,r,o){return t.platform=t.platform||"javascript",super._prepareEvent(t,n,r,o)}}function Ji(e){var t;return{release:typeof __SENTRY_RELEASE__=="string"?__SENTRY_RELEASE__:(t=E.SENTRY_RELEASE)==null?void 0:t.id,sendClientReports:!0,parentSpanIsAlwaysRootSpan:!0,...e}}const qi=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,b=m,Ki=1e3;let un,tt,nt;function Zi(e){G("dom",e),W("dom",ea)}function ea(){if(!b.document)return;const e=k.bind(null,"dom"),t=ln(e,!0);b.document.addEventListener("click",t,!1),b.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(n=>{var s,i;const o=(s=b[n])==null?void 0:s.prototype;(i=o==null?void 0:o.hasOwnProperty)!=null&&i.call(o,"addEventListener")&&(w(o,"addEventListener",function(a){return function(c,u,l){if(c==="click"||c=="keypress")try{const f=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},h=f[c]=f[c]||{refCount:0};if(!h.handler){const d=ln(e);h.handler=d,a.call(this,c,d,l)}h.refCount++}catch{}return a.call(this,c,u,l)}}),w(o,"removeEventListener",function(a){return function(c,u,l){if(c==="click"||c=="keypress")try{const f=this.__sentry_instrumentation_handlers__||{},h=f[c];h&&(h.refCount--,h.refCount<=0&&(a.call(this,c,h.handler,l),h.handler=void 0,delete f[c]),Object.keys(f).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return a.call(this,c,u,l)}}))})}function ta(e){if(e.type!==tt)return!1;try{if(!e.target||e.target._sentryId!==nt)return!1}catch{}return!0}function na(e,t){return e!=="keypress"?!1:t!=null&&t.tagName?!(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable):!0}function ln(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;const r=ra(n);if(na(n.type,r))return;U(n,"_sentryCaptured",!0),r&&!r._sentryId&&U(r,"_sentryId",I());const o=n.type==="keypress"?"input":n.type;ta(n)||(e({event:n,name:o,global:t}),tt=n.type,nt=r?r._sentryId:void 0),clearTimeout(un),un=b.setTimeout(()=>{nt=void 0,tt=void 0},Ki)}}function ra(e){try{return e.target}catch{return null}}let he;function tr(e){const t="history";G(t,e),W(t,oa)}function oa(){if(b.addEventListener("popstate",()=>{const t=b.location.href,n=he;if(he=t,n===t)return;k("history",{from:n,to:t})}),!ki())return;function e(t){return function(...n){const r=n.length>2?n[2]:void 0;if(r){const o=he,s=sa(String(r));if(he=s,o===s)return t.apply(this,n);k("history",{from:o,to:s})}return t.apply(this,n)}}w(b.history,"pushState",e),w(b.history,"replaceState",e)}function sa(e){try{return new URL(e,b.location.origin).toString()}catch{return e}}const Ee={};function ia(e){const t=Ee[e];if(t)return t;let n=b[e];if(qe(n))return Ee[e]=n.bind(b);const r=b.document;if(r&&typeof r.createElement=="function")try{const o=r.createElement("iframe");o.hidden=!0,r.head.appendChild(o);const s=o.contentWindow;s!=null&&s[e]&&(n=s[e]),r.head.removeChild(o)}catch(o){qi&&p.warn(`Could not create sandbox iframe for ${e} check, bailing to window.${e}: `,o)}return n&&(Ee[e]=n.bind(b))}function fn(e){Ee[e]=void 0}const Z="__sentry_xhr_v3__";function aa(e){G("xhr",e),W("xhr",ca)}function ca(){if(!b.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;e.open=new Proxy(e.open,{apply(t,n,r){const o=new Error,s=C()*1e3,i=R(r[0])?r[0].toUpperCase():void 0,a=ua(r[1]);if(!i||!a)return t.apply(n,r);n[Z]={method:i,url:a,request_headers:{}},i==="POST"&&a.match(/sentry_key/)&&(n.__sentry_own_request__=!0);const c=()=>{const u=n[Z];if(u&&n.readyState===4){try{u.status_code=n.status}catch{}const l={endTimestamp:C()*1e3,startTimestamp:s,xhr:n,virtualError:o};k("xhr",l)}};return"onreadystatechange"in n&&typeof n.onreadystatechange=="function"?n.onreadystatechange=new Proxy(n.onreadystatechange,{apply(u,l,f){return c(),u.apply(l,f)}}):n.addEventListener("readystatechange",c),n.setRequestHeader=new Proxy(n.setRequestHeader,{apply(u,l,f){const[h,d]=f,y=l[Z];return y&&R(h)&&R(d)&&(y.request_headers[h.toLowerCase()]=d),u.apply(l,f)}}),t.apply(n,r)}}),e.send=new Proxy(e.send,{apply(t,n,r){const o=n[Z];if(!o)return t.apply(n,r);r[0]!==void 0&&(o.body=r[0]);const s={startTimestamp:C()*1e3,xhr:n};return k("xhr",s),t.apply(n,r)}})}function ua(e){if(R(e))return e;try{return e.toString()}catch{}}function la(e,t=ia("fetch")){let n=0,r=0;function o(s){const i=s.body.length;n+=i,r++;const a={body:s.body,method:"POST",referrerPolicy:"strict-origin",headers:e.headers,keepalive:n<=6e4&&r<15,...e.fetchOptions};if(!t)return fn("fetch"),we("No fetch implementation available");try{return t(e.url,a).then(c=>(n-=i,r--,{statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}}))}catch(c){return fn("fetch"),n-=i,r--,we(c)}}return Ks(e,o)}const fa=30,da=50;function rt(e,t,n,r){const o={filename:e,function:t==="<anonymous>"?O:t,in_app:!0};return n!==void 0&&(o.lineno=n),r!==void 0&&(o.colno=r),o}const pa=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,ha=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,ga=/\((\S*)(?::(\d+))(?::(\d+))\)/,ma=e=>{const t=pa.exec(e);if(t){const[,r,o,s]=t;return rt(r,O,+o,+s)}const n=ha.exec(e);if(n){if(n[2]&&n[2].indexOf("eval")===0){const i=ga.exec(n[2]);i&&(n[2]=i[1],n[3]=i[2],n[4]=i[3])}const[o,s]=nr(n[1]||O,n[2]);return rt(s,o,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}},_a=[fa,ma],Ea=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,ya=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Aa=e=>{const t=Ea.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const s=ya.exec(t[3]);s&&(t[1]=t[1]||"eval",t[3]=s[1],t[4]=s[2],t[5]="")}let r=t[3],o=t[1]||O;return[o,r]=nr(o,r),rt(r,o,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}},ba=[da,Aa],Sa=[_a,ba],wa=bn(...Sa),nr=(e,t)=>{const n=e.indexOf("safari-extension")!==-1,r=e.indexOf("safari-web-extension")!==-1;return n||r?[e.indexOf("@")!==-1?e.split("@")[0]:O,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]},xe=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,ge=1024,Ta="Breadcrumbs",Ba=((e={})=>{const t={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e};return{name:Ta,setup(n){t.console&&Ei(Da(n)),t.dom&&Zi(va(n,t.dom)),t.xhr&&aa(Ra(n)),t.fetch&&Ri(Ca(n)),t.history&&tr(Na(n)),t.sentry&&n.on("beforeSendEvent",ka(n))}}}),Ia=Ba;function ka(e){return function(n){S()===e&&H({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:M(n)},{event:n})}}function va(e,t){return function(r){if(S()!==e)return;let o,s,i=typeof t=="object"?t.serializeAttribute:void 0,a=typeof t=="object"&&typeof t.maxStringLength=="number"?t.maxStringLength:void 0;a&&a>ge&&(xe&&p.warn(`\`dom.maxStringLength\` cannot exceed ${ge}, but a value of ${a} was configured. Sentry will use ${ge} instead.`),a=ge),typeof i=="string"&&(i=[i]);try{const u=r.event,l=xa(u)?u.target:u;o=Bn(l,{keyAttrs:i,maxStringLength:a}),s=Zr(l)}catch{o="<unknown>"}if(o.length===0)return;const c={category:`ui.${r.name}`,message:o};s&&(c.data={"ui.component_name":s}),H(c,{event:r.event,name:r.name,global:r.global})}}function Da(e){return function(n){if(S()!==e)return;const r={category:"console",data:{arguments:n.args,logger:"console"},level:Ai(n.level),message:kt(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)r.message=`Assertion failed: ${kt(n.args.slice(1)," ")||"console.assert"}`,r.data.arguments=n.args.slice(1);else return;H(r,{input:n.args,level:n.level})}}function Ra(e){return function(n){if(S()!==e)return;const{startTimestamp:r,endTimestamp:o}=n,s=n.xhr[Z];if(!r||!o||!s)return;const{method:i,url:a,status_code:c,body:u}=s,l={method:i,url:a,status_code:c},f={xhr:n.xhr,input:u,startTimestamp:r,endTimestamp:o},h={category:"xhr",data:l,type:"http",level:Kn(c)};e.emit("beforeOutgoingRequestBreadcrumb",h,f),H(h,f)}}function Ca(e){return function(n){if(S()!==e)return;const{startTimestamp:r,endTimestamp:o}=n;if(o&&!(n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST"))if(n.fetchData.method,n.fetchData.url,n.error){const s=n.fetchData,i={data:n.error,input:n.args,startTimestamp:r,endTimestamp:o},a={category:"fetch",data:s,level:"error",type:"http"};e.emit("beforeOutgoingRequestBreadcrumb",a,i),H(a,i)}else{const s=n.response,i={...n.fetchData,status_code:s==null?void 0:s.status};n.fetchData.request_body_size,n.fetchData.response_body_size,s==null||s.status;const a={input:n.args,response:s,startTimestamp:r,endTimestamp:o},c={category:"fetch",data:i,type:"http",level:Kn(i.status_code)};e.emit("beforeOutgoingRequestBreadcrumb",c,a),H(c,a)}}}function Na(e){return function(n){if(S()!==e)return;let r=n.from,o=n.to;const s=He(E.location.href);let i=r?He(r):void 0;const a=He(o);i!=null&&i.path||(i=s),s.protocol===a.protocol&&s.host===a.host&&(o=a.relative),s.protocol===i.protocol&&s.host===i.host&&(r=i.relative),H({category:"navigation",data:{from:r,to:o}})}}function xa(e){return!!e&&!!e.target}const Fa=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],Qa="BrowserApiErrors",La=((e={})=>{const t={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,unregisterOriginalCallbacks:!1,...e};return{name:Qa,setupOnce(){t.setTimeout&&w(E,"setTimeout",dn),t.setInterval&&w(E,"setInterval",dn),t.requestAnimationFrame&&w(E,"requestAnimationFrame",Pa),t.XMLHttpRequest&&"XMLHttpRequest"in E&&w(XMLHttpRequest.prototype,"send",Oa);const n=t.eventTarget;n&&(Array.isArray(n)?n:Fa).forEach(o=>Ua(o,t))}}}),Ma=La;function dn(e){return function(...t){const n=t[0];return t[0]=z(n,{mechanism:{data:{function:x(e)},handled:!1,type:"instrument"}}),e.apply(this,t)}}function Pa(e){return function(t){return e.apply(this,[z(t,{mechanism:{data:{function:"requestAnimationFrame",handler:x(e)},handled:!1,type:"instrument"}})])}}function Oa(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(o=>{o in n&&typeof n[o]=="function"&&w(n,o,function(s){const i={mechanism:{data:{function:o,handler:x(s)},handled:!1,type:"instrument"}},a=ht(s);return a&&(i.mechanism.data.handler=x(a)),z(s,i)})}),e.apply(this,t)}}function Ua(e,t){var o,s;const r=(o=E[e])==null?void 0:o.prototype;(s=r==null?void 0:r.hasOwnProperty)!=null&&s.call(r,"addEventListener")&&(w(r,"addEventListener",function(i){return function(a,c,u){try{$a(c)&&(c.handleEvent=z(c.handleEvent,{mechanism:{data:{function:"handleEvent",handler:x(c),target:e},handled:!1,type:"instrument"}}))}catch{}return t.unregisterOriginalCallbacks&&Ha(this,a,c),i.apply(this,[a,z(c,{mechanism:{data:{function:"addEventListener",handler:x(c),target:e},handled:!1,type:"instrument"}}),u])}}),w(r,"removeEventListener",function(i){return function(a,c,u){try{const l=c.__sentry_wrapped__;l&&i.call(this,a,l,u)}catch{}return i.call(this,a,c,u)}}))}function $a(e){return typeof e.handleEvent=="function"}function Ha(e,t,n){e&&typeof e=="object"&&"removeEventListener"in e&&typeof e.removeEventListener=="function"&&e.removeEventListener(t,n)}const Ga=()=>({name:"BrowserSession",setupOnce(){if(typeof E.document>"u"){xe&&p.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.");return}Yt({ignoreDuration:!0}),zt(),tr(({from:e,to:t})=>{e!==void 0&&e!==t&&(Yt({ignoreDuration:!0}),zt())})}}),Wa="GlobalHandlers",ja=((e={})=>{const t={onerror:!0,onunhandledrejection:!0,...e};return{name:Wa,setupOnce(){Error.stackTraceLimit=50},setup(n){t.onerror&&(Ya(n),pn("onerror")),t.onunhandledrejection&&(za(n),pn("onunhandledrejection"))}}}),Va=ja;function Ya(e){Hr(t=>{const{stackParser:n,attachStacktrace:r}=rr();if(S()!==e||Zn())return;const{msg:o,url:s,line:i,column:a,error:c}=t,u=qa(At(n,c||o,void 0,r,!1),s,i,a);u.level="error",Un(u,{originalException:c,mechanism:{handled:!1,type:"onerror"}})})}function za(e){Wr(t=>{const{stackParser:n,attachStacktrace:r}=rr();if(S()!==e||Zn())return;const o=Xa(t),s=ft(o)?Ja(o):At(n,o,void 0,r,!0);s.level="error",Un(s,{originalException:o,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function Xa(e){if(ft(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}function Ja(e){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(e)}`}]}}}function qa(e,t,n,r){const o=e.exception=e.exception||{},s=o.values=o.values||[],i=s[0]=s[0]||{},a=i.stacktrace=i.stacktrace||{},c=a.frames=a.frames||[],u=r,l=n,f=R(t)&&t.length>0?t:pt();return c.length===0&&c.push({colno:u,filename:f,function:O,in_app:!0,lineno:l}),e}function pn(e){xe&&p.log(`Global Handler attached: ${e}`)}function rr(){const e=S();return(e==null?void 0:e.getOptions())||{stackParser:()=>[],attachStacktrace:!1}}const Ka=()=>({name:"HttpContext",preprocessEvent(e){var r;if(!E.navigator&&!E.location&&!E.document)return;const t=Li(),n={...t.headers,...(r=e.request)==null?void 0:r.headers};e.request={...t,...e.request,headers:n}}}),Za="cause",ec=5,tc="LinkedErrors",nc=((e={})=>{const t=e.limit||ec,n=e.key||Za;return{name:tc,preprocessEvent(r,o,s){const i=s.getOptions();_i(Et,i.stackParser,n,t,r,o)}}}),rc=nc;function oc(){return sc()?(xe&&X(()=>{console.error("[Sentry] You cannot use Sentry.init() in a browser extension, see: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")}),!0):!1}function sc(){var s;if(typeof E.window>"u")return!1;const e=E;if(e.nw)return!1;const t=e.chrome||e.browser;if(!((s=t==null?void 0:t.runtime)!=null&&s.id))return!1;const n=pt(),r=["chrome-extension","moz-extension","ms-browser-extension","safari-web-extension"];return!(E===E.top&&r.some(i=>n.startsWith(`${i}://`)))}function ic(e){return[ui(),si(),Ma(),Ia(),Va(),rc(),wi(),Ka(),Ga()]}function ac(e={}){const t=!e.skipBrowserExtensionCheck&&oc(),n={...e,enabled:t?!1:e.enabled,stackParser:Ur(e.stackParser||wa),integrations:Ns({integrations:e.integrations,defaultIntegrations:e.defaultIntegrations==null?ic():e.defaultIntegrations}),transport:e.transport||la};return Gs(Xi,n)}window.startWaterController=function(){console.log("🚀 全局函数被调用：启动水控器");const e=document.getElementById("main-button");e&&(e.textContent="连接中...",e.disabled=!0);try{console.log("✅ 调用handleButtonClick函数"),En()}catch(t){console.error("🔥 启动水控器失败:",t),e&&(e.textContent="开启",e.disabled=!1);const n=t instanceof Error?t.message:String(t);n.includes("navigator.bluetooth")?alert(`🚫 蓝牙API不可用

🔧 解决方案：
1️⃣ 确保使用Chrome、Edge或Firefox最新版本
2️⃣ 检查网站是否使用HTTPS协议
3️⃣ 在Chrome中启用蓝牙实验性功能
4️⃣ 重启浏览器后重试

当前错误：${n}`):alert("启动失败: "+n)}};window.clearPairedDevices=async function(){console.log("🧹 全局函数被调用：清除配对设备 - 增强版");try{if(!navigator.bluetooth){const i=`❌ 您的浏览器不支持Web Bluetooth API

🔧 解决方案：
1️⃣ 使用Chrome 56+、Edge 79+或Opera 43+
2️⃣ 确保网站使用HTTPS协议访问
3️⃣ 检查地址栏是否显示🔒安全连接

📋 当前状态：
• 浏览器：${navigator.userAgent.split(" ")[0]}
• 协议：${location.protocol}
• 域名：${location.hostname}`;alert(i);return}if(!navigator.bluetooth.getDevices){if(alert(`⚠️ 您的Chrome浏览器需要启用实验性功能

🔧 启用步骤：
1️⃣ 在地址栏输入：chrome://flags/
2️⃣ 搜索：Experimental Web Platform features  
3️⃣ 设置为：Enabled
4️⃣ 重启Chrome浏览器

🆘 备用方案：
• 手动清除：chrome://bluetooth-internals/
• 系统设置：Windows设置 > 蓝牙和其他设备`),confirm("💡 是否打开Chrome蓝牙调试页面？"))try{window.open("chrome://bluetooth-internals/","_blank")}catch{console.log("无法打开Chrome内部页面，用户需要手动访问")}return}console.log("✅ 浏览器支持检查通过，开始获取设备列表...");const e=await navigator.bluetooth.getDevices();if(console.log("📱 已配对设备列表:",e),console.log(`📊 设备数量: ${e.length}`),e.length===0){alert(`✅ 当前没有已配对的蓝牙设备

🔍 如果仍有连接问题，请尝试：
• 重启浏览器并重新访问此页面
• 清除浏览器缓存和Cookie
• 关闭蓝牙适配器，等待5秒后重新打开
• 重启电脑的蓝牙服务`);return}const t=e.map(i=>i.name||i.id||"未知设备").join(`
• `),n=`🔍 找到 ${e.length} 个已配对设备：

• ${t}

⚠️ 确定要清除这些设备吗？
清除后需要重新配对才能连接。`;if(!confirm(n)){console.log("用户取消了清除操作");return}let r=0,o=[];for(const i of e)try{const a=i.name||i.id||"未知设备";console.log(`🗑️ 正在清除设备: ${a}`),i.forget&&typeof i.forget=="function"?(await i.forget(),r++,console.log(`✅ 已清除设备: ${a}`)):(console.log(`⚠️ 设备不支持forget方法: ${a}`),o.push(a))}catch(a){const c=i.name||i.id||"未知设备";console.error(`❌ 清除设备失败: ${c}`,a),o.push(c)}let s="";r>0?(s=`🎉 成功清除 ${r} 个蓝牙设备！`,o.length>0&&(s+=`

⚠️ ${o.length} 个设备清除失败：
• ${o.join(`
• `)}

💡 手动清除方法：
1️⃣ 系统设置 → 蓝牙和其他设备
2️⃣ 找到对应设备并点击"移除"`),s+=`

🔄 页面将刷新以应用更改...`,alert(s),setTimeout(()=>{window.location.reload()},1500)):(s=`❌ 无法清除任何设备

🔧 可能的原因：
• 浏览器安全限制
• 设备被其他程序占用
• 蓝牙驱动程序问题

💡 解决方案：
1️⃣ 关闭所有蓝牙相关程序
2️⃣ 手动在系统设置中清除
3️⃣ 重启蓝牙适配器`,alert(s))}catch(e){console.error("❌ 清除配对设备过程中发生错误:",e);let t=`❌ 清除配对设备失败

`;const n=e.message||String(e);n.includes("not allowed")||n.includes("denied")?t+=`🚫 权限被拒绝

🔧 解决方法：
1️⃣ 刷新页面并重试
2️⃣ 检查浏览器权限设置
3️⃣ 确保使用HTTPS访问
4️⃣ 尝试无痕模式访问`:n.includes("not supported")||n.includes("undefined")?t+=`⚠️ 浏览器不支持此功能

🔧 解决方法：
1️⃣ 更新Chrome到最新版本
2️⃣ 启用实验性Web平台功能
3️⃣ 使用支持的浏览器版本`:n.includes("timeout")||n.includes("time")?t+=`⏱️ 操作超时

🔧 解决方法：
1️⃣ 检查蓝牙适配器状态
2️⃣ 重启蓝牙服务
3️⃣ 减少干扰后重试`:t+=`🐛 未知错误：${n}

🔧 通用解决方法：
1️⃣ 刷新页面重试
2️⃣ 重启浏览器
3️⃣ 手动清除蓝牙设备
4️⃣ 检查控制台详细错误信息`,alert(t)}};ac({dsn:"https://17d03841e2244d53abdbe587434efd5c@glitchtip.celeswuff.science/1"});document.getElementById("version").innerText=" · v0.0.1";async function or(){const e=document.getElementById("bluetooth-status");if(!e){console.log("未找到蓝牙状态元素，将重试..."),setTimeout(or,200);return}console.log("开始检测蓝牙支持...");try{if(typeof navigator>"u"||!navigator.bluetooth){e.innerHTML="❌ 浏览器不支持蓝牙 API",e.style.color="rgba(255, 99, 71, 0.9)",console.log("蓝牙支持检测完成：不支持（API不存在）");return}await navigator.bluetooth.getAvailability()?(e.innerHTML="✅ 蓝牙功能可用",e.style.color="rgba(144, 238, 144, 0.9)",console.log("蓝牙支持检测完成：可用")):(e.innerHTML="⚠️ 蓝牙硬件不可用或未开启",e.style.color="rgba(255, 215, 0, 0.9)",console.log("蓝牙支持检测完成：硬件不可用"))}catch(t){navigator.bluetooth?(e.innerHTML="⚠️ 浏览器支持蓝牙，但无法检测硬件状态",e.style.color="rgba(255, 215, 0, 0.9)",console.log("蓝牙支持检测完成：API存在但无法检测硬件")):(e.innerHTML="❌ 蓝牙检测出错",e.style.color="rgba(255, 99, 71, 0.9)",console.error("蓝牙检测错误:",t))}}let hn=!1;function gn(){if(hn){console.log("应用已初始化，跳过重复初始化");return}console.log("开始初始化应用...");const e=document.querySelector(".supported");e&&(e.style.display="block",console.log("主界面已显示")),or();const t=document.getElementById("main-button");if(t){console.log("✅ 找到按钮元素:",t),console.log("✅ 按钮当前disabled状态:",t.disabled),console.log("✅ 按钮当前style:",t.style.cssText),t.disabled=!1,t.style.pointerEvents="auto !important",t.style.cursor="pointer !important",t.style.zIndex="9999";const r=function(o){console.log("� 按钮被点击！事件类型:",o.type),o.preventDefault(),o.stopPropagation();try{window.startWaterController()}catch(s){console.error("按钮点击处理出错:",s),En()}};t.onclick=r,t.addEventListener("click",r,{capture:!0}),t.addEventListener("mousedown",r,{capture:!0}),console.log("按钮事件已绑定（使用onclick）")}else console.error("❌ 未找到主按钮元素！");const n=document.getElementById("clear-pairing-button");if(n){console.log("✅ 找到清除配对按钮:",n),n.disabled=!1,n.style.pointerEvents="auto !important",n.style.cursor="pointer !important",n.style.zIndex="9999";const r=async function(o){console.log("🧹 清除配对按钮被点击！事件类型:",o.type),o.preventDefault(),o.stopPropagation();try{await window.clearPairedDevices()}catch(s){console.error("调用清除配对设备函数出错:",s),alert("清除配对设备功能暂时不可用，请刷新页面重试")}};n.onclick=r,n.addEventListener("click",r,{capture:!0}),n.addEventListener("mousedown",r,{capture:!0}),console.log("✅ 清除配对按钮事件已绑定（三重保险）")}setTimeout(()=>{console.log("🔧 执行按钮状态强化修复...");const r=document.getElementById("main-button");r&&(r.style.pointerEvents="auto",r.style.cursor="pointer",r.style.userSelect="none",r.disabled=!1,r.classList.remove("disabled","hidden"),console.log("✅ 主按钮状态已强化"));const o=document.getElementById("clear-pairing-button");o&&(o.style.pointerEvents="auto",o.style.cursor="pointer",o.style.userSelect="none",o.disabled=!1,o.classList.remove("disabled","hidden"),console.log("✅ 清除配对按钮状态已强化"));const s=document.getElementById("install-button");s?(console.log("🔍 发现安装按钮存在，状态:",{display:getComputedStyle(s).display,visibility:getComputedStyle(s).visibility,disabled:s.disabled}),s.style.zIndex="1"):console.log("🔍 未发现安装按钮，这可能是某些设备上按钮不工作的原因"),document.body.style.pointerEvents="auto"},500),hn=!0,console.log("应用初始化完成")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",gn):setTimeout(gn,10);Rr();Cr();Nr();
//# sourceMappingURL=index.js.map</script><style rel="stylesheet" crossorigin>:root{--background-body:#fff;--background:#efefef;--background-alt:#f7f7f7;--selection:#9e9e9e;--text-main:#363636;--text-bright:#000;--text-muted:#70777f;--links:#0076d1;--focus:rgba(0,150,191,.67);--border:#dbdbdb;--code:#000;--animation-duration:.1s;--button-base:#d0cfcf;--button-hover:#9b9b9b;--scrollbar-thumb:#aaa;--scrollbar-thumb-hover:var(--button-hover);--form-placeholder:#949494;--form-text:#1d1d1d;--variable:#39a33c;--highlight:#ff0;--select-arrow:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' height='63' width='117' fill='%23161f27'%3E%3Cpath d='M115 2c-1-2-4-2-5 0L59 53 7 2a4 4 0 00-5 5l54 54 2 2 3-2 54-54c2-1 2-4 0-5z'/%3E%3C/svg%3E")}html{scrollbar-color:#aaa #fff;scrollbar-color:var(--scrollbar-thumb) var(--background-body);scrollbar-width:thin}body{font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,Segoe UI Emoji,Apple Color Emoji,Noto Color Emoji,sans-serif;line-height:1.4;max-width:800px;margin:20px auto;padding:0 10px;word-wrap:break-word;color:#363636;color:var(--text-main);background:#fff;background:var(--background-body);text-rendering:optimizeLegibility}button{transition:background-color .1s linear,border-color .1s linear,color .1s linear,box-shadow .1s linear,transform .1s ease;transition:background-color var(--animation-duration) linear,border-color var(--animation-duration) linear,color var(--animation-duration) linear,box-shadow var(--animation-duration) linear,transform var(--animation-duration) ease}h2{margin-bottom:12px;margin-top:24px}h2{color:#000;color:var(--text-bright)}h2{font-weight:600}a>code{color:inherit}button{cursor:pointer}button{color:#1d1d1d;color:var(--form-text);background-color:#efefef;background-color:var(--background);font-family:inherit;font-size:inherit;margin-right:6px;margin-bottom:6px;padding:10px;border:none;border-radius:6px;outline:0}button{background-color:#d0cfcf;background-color:var(--button-base);padding-right:30px;padding-left:30px}button:hover{background:#9b9b9b;background:var(--button-hover)}button{-webkit-appearance:none}button:focus{box-shadow:0 0 0 2px #0096bfab;box-shadow:0 0 0 2px var(--focus)}button:active{transform:translateY(2px)}button:disabled{cursor:not-allowed;opacity:.5}::-moz-placeholder{color:#949494;color:var(--form-placeholder)}::-ms-input-placeholder{color:#949494;color:var(--form-placeholder)}::placeholder{color:#949494;color:var(--form-placeholder)}a{text-decoration:none;color:#0076d1;color:var(--links)}a:hover{text-decoration:underline}code{background:#efefef;background:var(--background);color:#000;color:var(--code);padding:2.5px 5px;border-radius:6px;font-size:1em}pre>code{padding:10px;display:block;overflow-x:auto}::-webkit-scrollbar{height:10px;width:10px}::-webkit-scrollbar-track{background:#efefef;background:var(--background);border-radius:6px}::-webkit-scrollbar-thumb{background:#aaa;background:var(--scrollbar-thumb);border-radius:6px}::-webkit-scrollbar-thumb:hover{background:#9b9b9b;background:var(--scrollbar-thumb-hover)}::-moz-selection{background-color:#9e9e9e;background-color:var(--selection);color:#000;color:var(--text-bright)}::selection{background-color:#9e9e9e;background-color:var(--selection);color:#000;color:var(--text-bright)}dialog{background-color:#f7f7f7;background-color:var(--background-alt);color:#363636;color:var(--text-main);border-radius:6px;border:#dbdbdb;border-color:var(--border);padding:10px 30px}dialog>header:first-child{background-color:#efefef;background-color:var(--background);border-radius:6px 6px 0 0;margin:-10px -30px 10px;padding:10px;text-align:center}dialog::-webkit-backdrop{background:#0000009c;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}dialog::backdrop{background:#0000009c;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}@media print{body,button,code,pre{background-color:#fff}button{border:1px solid #000}body,button,code,h2,pre{color:#000}a{color:#00f;text-decoration:underline}}body{background:linear-gradient(135deg,#667eea,#764ba2)!important;background-attachment:fixed!important;min-height:100vh!important;margin:0!important;padding:0!important;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif!important;overflow-x:hidden!important}.main{position:absolute!important;left:50%!important;top:50%!important;-webkit-transform:translate(-50%,-50%)!important;transform:translate(-50%,-50%)!important;display:flex!important;align-items:center!important;justify-content:center!important;flex-direction:column!important;background:#ffffff26!important;backdrop-filter:blur(15px)!important;-webkit-backdrop-filter:blur(15px)!important;border-radius:25px!important;padding:40px 50px!important;border:2px solid rgba(255,255,255,.3)!important;box-shadow:0 15px 45px #0003!important;min-width:350px!important;max-width:500px!important;text-align:center!important;margin:0!important}.main h2{color:#fff!important;text-shadow:0 3px 6px rgba(0,0,0,.4)!important;margin-top:0!important;margin-bottom:15px!important;font-size:28px!important;font-weight:700!important}.main p{color:#fffffff2!important;text-shadow:0 1px 3px rgba(0,0,0,.3)!important;margin:8px 0!important;font-size:15px!important;line-height:1.6!important}#main-button{background:linear-gradient(45deg,#4facfe,#00f2fe)!important;border:none!important;color:#fff!important;padding:15px 35px!important;font-size:18px!important;font-weight:700!important;border-radius:30px!important;cursor:pointer!important;transition:all .3s ease!important;box-shadow:0 6px 20px #4facfe66!important;text-shadow:0 2px 4px rgba(0,0,0,.3)!important;margin:15px 0!important;min-width:150px!important;text-transform:uppercase!important;letter-spacing:1px!important}#main-button:hover{transform:translateY(-3px)!important;box-shadow:0 8px 25px #4facfe99!important;background:linear-gradient(45deg,#00f2fe,#4facfe)!important}#main-button:active{transform:translateY(-1px)!important;box-shadow:0 4px 15px #4facfe80!important}#main-button:disabled{opacity:.6!important;cursor:not-allowed!important;transform:none!important;background:linear-gradient(45deg,#888,#666)!important;box-shadow:0 4px 15px #0003!important}.main button{background:#fff3;border:1px solid rgba(255,255,255,.3);color:#fff;padding:8px 16px;border-radius:15px;cursor:pointer;transition:all .2s ease}.main button:hover{background:#ffffff4d;transform:translateY(-1px)}.main a{color:#ffffffe6;text-decoration:none}.main a:hover{color:#fff;text-decoration:underline}.misc{position:absolute;bottom:0;left:0;margin:10px;color:#ffffffb3;font-size:12px}.misc a{color:#fffc;text-decoration:none}.misc a:hover{color:#fff!important;text-decoration:underline!important}#install-button{background:#fff3!important;border:1px solid rgba(255,255,255,.3);color:#fff;padding:8px 16px;border-radius:10px;cursor:pointer;font-size:12px;margin-bottom:10px;display:block}#install-button:hover{background:#ffffff4d}</style></head><body><div class="main supported"><noscript>需要启用 JavaScript。</noscript><h2 style="margin-top:0;color:#fff;text-shadow:0 2px 4px rgba(0,0,0,.3)">🛀 蓝牙水控器</h2><p id="bluetooth-status" style="color:rgba(255,255,255,.8);font-size:14px;margin:5px 0">检测蓝牙支持中...</p><button id="main-button" onclick="try{window.startWaterController && window.startWaterController(); console.log('✅HTML内联点击成功');}catch(e){console.error('❌HTML内联失败:',e);}" data-onclick="startWaterController" style="pointer-events:auto!important;cursor:pointer!important">开启</button> <button id="clear-pairing-button" style="background:linear-gradient(45deg,#ff6b6b,#ee5a6f)!important;font-size:14px!important;padding:8px 20px!important;pointer-events:auto!important;cursor:pointer!important" onclick="try{window.clearPairedDevices && window.clearPairedDevices(); console.log('✅清除按钮HTML内联成功');}catch(e){console.error('❌清除按钮HTML内联失败:',e);}" data-onclick="clearPairedDevices">清除已配对设备</button><p id="device-name" style="margin-top:10px;margin-bottom:10px">未连接</p></div><script>// 立即执行蓝牙检测，不等待其他脚本加载
      (function() {
        async function quickBluetoothCheck() {
          const statusEl = document.getElementById("bluetooth-status");
          if (!statusEl) {
            setTimeout(quickBluetoothCheck, 50);
            return;
          }
          
          try {
            // 更严格的蓝牙检测
            if (typeof navigator === 'undefined' || !navigator.bluetooth) {
              statusEl.innerHTML = "❌ 浏览器不支持蓝牙 API";
              statusEl.style.color = "rgba(255, 99, 71, 0.9)";
              console.log("快速蓝牙检测：不支持（API不存在）");
              return;
            }

            // 测试蓝牙API是否真正可用
            try {
              const availability = await navigator.bluetooth.getAvailability();
              
              if (availability) {
                statusEl.innerHTML = "✅ 蓝牙功能可用";
                statusEl.style.color = "rgba(144, 238, 144, 0.9)";
                console.log("快速蓝牙检测：可用");
              } else {
                statusEl.innerHTML = "⚠️ 蓝牙硬件不可用或未开启";
                statusEl.style.color = "rgba(255, 215, 0, 0.9)";
                console.log("快速蓝牙检测：硬件不可用");
              }
            } catch (err) {
              statusEl.innerHTML = "⚠️ 浏览器支持蓝牙，但无法检测硬件状态";
              statusEl.style.color = "rgba(255, 215, 0, 0.9)";
              console.log("快速蓝牙检测：API存在但无法检测硬件");
            }
          } catch (error) {
            statusEl.innerHTML = "❌ 蓝牙检测出错";
            statusEl.style.color = "rgba(255, 99, 71, 0.9)";
            console.error("快速蓝牙检测错误:", error);
          }
        }
        
        // 🚀 立即强制绑定按钮事件 - 解决所有按钮问题
        function forceButtonBinding() {
          console.log("🚀 开始强制按钮绑定...");
          
          // 强制主按钮绑定
          const mainBtn = document.getElementById("main-button");
          if (mainBtn) {
            console.log("✅ 找到主按钮，开始强制绑定");
            
            // 确保按钮可点击
            mainBtn.style.pointerEvents = "auto";
            mainBtn.style.cursor = "pointer";
            mainBtn.disabled = false;
            
            // 强制点击处理器
            const mainClickHandler = function(e) {
              console.log("🎯 主按钮强制点击处理器触发！", e.type);
              e.preventDefault();
              e.stopPropagation();
              
              // 直接调用全局函数，不要延迟
              try {
                if (window.startWaterController) {
                  console.log("✅ 调用全局startWaterController函数");
                  window.startWaterController();
                } else {
                  console.log("❌ 全局函数未准备好，等待加载...");
                  // 等待函数加载，最多尝试3秒
                  let attempts = 0;
                  const checkInterval = setInterval(() => {
                    attempts++;
                    if (window.startWaterController) {
                      console.log("✅ 延迟调用全局函数成功");
                      clearInterval(checkInterval);
                      window.startWaterController();
                    } else if (attempts > 30) { // 30 * 100ms = 3秒
                      clearInterval(checkInterval);
                      console.log("⚠️ 函数加载超时，请刷新页面");
                      alert("蓝牙功能加载中，请稍等片刻后重试，或刷新页面");
                    }
                  }, 100);
                }
              } catch (error) {
                console.error("按钮点击处理出错:", error);
                alert("蓝牙功能启动失败: " + error.message);
              }
            };
            
            // 多重事件绑定
            mainBtn.onclick = mainClickHandler;
            mainBtn.addEventListener("click", mainClickHandler, true);
            mainBtn.addEventListener("mousedown", mainClickHandler, true);
            console.log("✅ 主按钮强制绑定完成");
          }
          
          // 强制清除按钮绑定
          const clearBtn = document.getElementById("clear-pairing-button");
          if (clearBtn) {
            console.log("✅ 找到清除按钮，开始强制绑定");
            
            // 确保按钮可点击
            clearBtn.style.pointerEvents = "auto";
            clearBtn.style.cursor = "pointer";
            clearBtn.disabled = false;
            
            // 强制点击处理器
            const clearClickHandler = function(e) {
              console.log("🧹 清除按钮强制点击处理器触发！", e.type);
              e.preventDefault();
              e.stopPropagation();
              
              // 显示用户反馈
              this.textContent = "清除中...";
              this.disabled = true;
              
              // 使用内联的清除逻辑（临时方案）
              setTimeout(async () => {
                try {
                  if (window.clearPairedDevices) {
                    await window.clearPairedDevices();
                  } else {
                    console.log("⚠️ 主脚本未加载，使用内联清除逻辑");
                    
                    if (!navigator.bluetooth || !navigator.bluetooth.getDevices) {
                      alert("您的浏览器不支持获取已配对设备\n\n请使用Chrome最新版本并启用实验性功能");
                    } else {
                      const devices = await navigator.bluetooth.getDevices();
                      if (devices.length === 0) {
                        alert("没有已配对的蓝牙设备");
                      } else {
                        alert(`找到 ${devices.length} 个设备，功能正在加载中...`);
                      }
                    }
                    
                    this.textContent = "清除已配对设备";
                    this.disabled = false;
                  }
                } catch (error) {
                  console.error("清除设备错误:", error);
                  alert("操作失败: " + error.message);
                  this.textContent = "清除已配对设备";
                  this.disabled = false;
                }
              }, 100);
            };
            
            // 多重事件绑定
            clearBtn.onclick = clearClickHandler;
            clearBtn.addEventListener("click", clearClickHandler, true);
            clearBtn.addEventListener("mousedown", clearClickHandler, true);
            console.log("✅ 清除按钮强制绑定完成");
          }
        }
        
        // 添加调试功能，帮助检测按钮点击
        function setupDebugClick() {
          const btn = document.getElementById("main-button");
          if (btn) {
            console.log("🔍 调试：找到按钮元素", btn);
            btn.addEventListener("click", function(e) {
              console.log("🔍 调试：按钮被点击！", e);
              console.log("🔍 调试：按钮disabled状态:", this.disabled);
              console.log("🔍 调试：按钮样式:", window.getComputedStyle(this));
            }, true); // 使用捕获阶段，优先级更高
          } else {
            console.log("🔍 调试：未找到按钮元素，将重试...");
            setTimeout(setupDebugClick, 100);
          }
        }
        
        // DOM加载完成后立即执行所有初始化
        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", function() {
            console.log("🚀 DOM加载完成，开始初始化...");
            quickBluetoothCheck();
            forceButtonBinding();
            setupDebugClick();
          });
        } else {
          console.log("🚀 DOM已就绪，立即初始化...");
          quickBluetoothCheck();
          forceButtonBinding();
          setupDebugClick();
        }
      })();</script><div class="misc"><button id="install-button">将蓝牙水控器 FOSS 安装到系统</button><p style="font-size:smaller;color:gray;margin:0"><a href="https://github.com/katelya77/watercracker" target="_blank">源代码</a> · <a href="https://github.com/katelya77/watercracker/blob/main/FAQ.md" target="_blank">疑难解答</a> <span id="version"></span><br/><span style="font-size:smaller">copyright (c) 2025 katelya, licensed under MIT License</span></p></div><dialog id="dialog"><header>出现错误</header><form method="dialog"><p id="dialog-content"></p><pre id="dialog-debug-container"><code id="dialog-debug-content"></code></pre><menu style="display:flex;justify-content:flex-end"><button onclick="succeeded = false">好</button></menu></form></dialog></body></html>